---
title: ThreatConnect Developer Reference

toc_footers:
  - <a href='https://github.com/ThreatConnect-Inc'>Star us on GitHub</a>
  - <a href='https://www.threatconnect.com/platform/editions/#basic'>Sign up for ThreatConnect (free)</a>

search: true

---

<br / >

# Getting Started

> Join the developer forum at [/r/threatconnect](https://www.reddit.com/r/threatconnect)

> Run into a bug? Let us know <support@threatconnect.com> 

The ThreatConnect platform enables developers to query their data and enrich it with powerful integrations. 

The [RESTful public API for ThreatConnect](#rest-api) is available to [developers with an API ID and Secret Key](#getting-your-api-key). 

JavaScript apps may be installed by any user with a [Basic account or higher ](https://www.threatconnect.com/platform/editions/#basic) with the [Spaces visualization feature](http://kb.threatconnect.com/customer/en/portal/articles/2256255-creating-a-space)

Official libraries to build a standalone App are available in [Python](#python-library), [Java](#java-library), and [JavaScript](#javascript-library) 

Python and Java Apps may be packaged and deployed on [ThreatConnect Exchange ](https://app.threatconnect.com/auth/exchange.xhtml), which is accessible to all ThreatConnect users

(Contact <support@threatconnect.com> to have your application listed in the Exchange)

[See an example of a Python app](#example-python-app) 

[See an example of a Java app](#example-java-app) 

[See an example of a JavaScript Spaces app](#example-javascript-app) 

Exchange Apps are executed on a recurring schedule (hourly, daily, etc). An app can have multiple jobs with different configurations. 

![App Lifecyle](images/app-lifecycle.png "App Lifecycle") 

Libraries in other languages are available for interfacing with the API, but are *not officially supported* 

- [Powershell](https://github.com/davidhowell-tx/PS-ThreatConnectV2API)

# REST API

The Application Programming Interface (API) allows users to access data in their Organizations and Communities with REST-ful queries to HTTP endpoints

## Creating an API Key

If you are not able to create an API key using to the steps provided below, please contact <sales@threatconnect.com> to discuss pricing.

To create an API key:

1.	Log in to the [ThreatConnect web application](https://app.threatconnect.com ) with your credentials
1.	Hover over your user name in the top right corner and select "Org Settings"
<img src="images/tcAPI_Figure2.png" alt="Figure 2"/><BR><BR>
1.	Create a new API User and configure the user information
<img src="images/tcAPI_Figure3.png" alt="Figure 3" <BR><BR>
    - The API User's name will identify this user in trusted communities
    - The pseudonym will appear instead of name in anonymous communities
     
Access ID identifies the user account and Secret Key authenticates the account.

## Using the API

The public ThreatConnect API is accessible at `https://api.threatconnect.com/v2/`

Requests to ThreatConnect API endpoints must be made over HTTPS with a valid Signature, or a `403` error will be returned

NOTE: ThreatConnect Enterprise users may need to add `/api/` to the API endpoint path, e.g. `https://tc-enterprise.threatconnect.com/api/v2`

> The example below details the path of a version 2 request to the Groups Service and Incidents-Collections Resource:

```
/v2/groups/incidents
```

Each API response is formatted with a status. If the status is "Success," each response includes a data field with the appropriate response type. If the status is "Failure," an appropriate error message is provided as to why the request failed. Available resources, request parameters, and example responses are located in the Services and Resources section of the document.

The API will be versioned as needed to support continued development of the ThreatConnect platform, and existing API versions will be appropriately deprecated.

Version 2 (V2) of the API supports write capabilities via HTTP POST and PUT methods, in addition to deletion via the HTTP DELETE method. As with Version 1 (V1) API Implementation, the HTTP GET method is used for read access to resources.

## Authentication

> Passing a Signature to the API

```
GET https://api.threatconnect.com/v2/indicators?owner=Common%20Community HTTP/1.1
 Timestamp: 1386658343
Authorization: TC 12345678901234567890: ljU65Zj30ueGL5y9oI01yW9cdfIllew0atg9D59yBXM =
 Host: api.threatconnect.com
```

Each request requires a valid `Authorization` header in the format `TC $API_ID:$SIGNATURE`

A `Timestamp` nonce in Unix epoch time must also be included (generated by `date +'%s'`) 

The Signature is created by concatenating the URL, HTTP method, and Timestamp as in:

`/v2/indicators/hosts/google.com?Owner=Common%20Community:GET:1381126486`

The result is then signed with the user's `Secret Key` using SHA256 as an HMAC as in [this code](https://github.com/ThreatConnect-Inc/threatconnect-python/blob/master/threatconnect/ThreatConnect.py#L135)

Note: If the nonce is not within five minutes of the ThreatConnect server's system time, a `403` error will be returned. 

## Example API GET Request

> Get a list of all Owners visible to this user

```
GET /v2/owners
```

> JSON Response:

```json
{
 "status": "Success",
 "data": {
  "owner": [{
   "id": 1,
   "name": "System",
   "type": "Organization"
  }, {
   "id": 26,
   "name": "Common Community",
   "type": "Community"
  }]
 }
}
```

> XML Response:

```xml
<ownersResponse>
 <Status>Success</Status>
 <Data xsi:type="ownerListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Owner xsi:type="organization">
   <Id>1</Id>
   <Name>System</Name>
   <Type>Organization</Type>
  </Owner>
  <Owner xsi:type="community">
   <Id>26</Id>
   <Name>Common Community</Name>
   <Type>Community</Type>
  </Owner>
 </Data>
</ownersResponse>
```

Clients should start with a request to the Owners service to return all Organizations and Communities to which the API credentials have access. This basic request is not dependent on data or Community permissions, but it is required that the request meets the Authentication requirements.

## Services and Resources

> The example below denotes the HTTP path of a request to the Groups Service and an Incidents-Collections Resource:

```
/v2/groups/incidents
```

> The example below is of a path that will return a specific Incident with an ID of 1:

```
/v2/groups/incidents/1
```

> The example below is of a path will return a specific Host:

```
/v2/indicators/hosts/baddomain.com
```

> The example below displays the path to which a request must be sent in order to obtain the associated Incidents of the above Host:

```
/v2/indicators/hosts/baddomain.com/groups/incidents
```

> This path returns all Incidents within the user’s Organization. 

```
/v2/groups/incidents
```

> The second path will return only Incidents associated to a specific Host with a value of baddomain.com:

```
/v2/indicators/hosts/baddomain.com/groups/incidents
```

Each ThreatConnect API Service and Resource is defined by the HTTP path of the request. To request a specific Resource from a Collection, append the appropriate identifier to the path. The API supports "pivoting" much like the ThreatConnect platform. Because the API supports pivoting and relationships, different request paths can return the same Resource Type, although limited in scope. Refer to [Resource Types](#resource-types) for supported resources and retrival paths.

<b>The Response</b>

Each API response includes a status. If the status is "Success," each response includes a data field with the appropriate response type. If the Status is "Failure," an appropriate error message is provided as to why the request failed.

By default, the API responds with a JSON-formatted message for each Resource request. If an XML-formatted response is desired, an HTTP Accept Header with a value of "application/xml" can be sent with the request.

###Collections Resources

> The example below is of sample Collections-request path with pagination-query parameters for Incidents:

```
/v2/groups/incidents?resultStart=0&resultLimit=50
```

For requests to Resources that are Collections, such as Incidents, Indicators, etc., pagination is required.

Pagination works by specifying a starting result index, as well as a result limit of items to be returned as HTTP query parameters to the request. For example, requesting a result start index of 50 and a result limit of 100 will retrieve items 50 to 150.

Table 2 displays the query parameters.

<b>Table 2 - Query Parameters</b>

HTTP Query <br> Parameter | Description                                                   | Default 
---------------------|---------------------------------------------------------------|---------
resultStart*         | The starting index of the result list that is returned        | 0       
resultLimit          | The limit to the number of results to return with the request | 100     

*Specifying a resultStart other than 0 will omit the resultCount field in the return data for performance reasons.

A Collections Resource request that does not include the parameters indicated is assumed to use the default values above. A request having a resultStart value of 0 will return the current count of all items in the Collection. This count should be saved to iterate over the Collection and to know when all items have been retrieved. The maximum value that can be specified for resultLimit is 500.

NOTE: Pagination counts and Indices should not be stored in long-lived applications as a way to return to a resultset. The dataset will change with time, so those range markers might cause objects to be skipped or duplicated if reused at a later time.

###Owners Service

> Owners Service JSON Response:

```json
{
 "status": "Success",
 "data": {
  "owner": [{
   "id": 1,
   "name": "System",
   "type": "Organization"
  }, {
   "id": 26,
   "name": "Common Community",
   "type": "Community"
  }]
 }
}
```

> Owners Service XML Response:

```xml
<ownersResponse>
 <Status>Success</Status>
 <Data xsi:type="ownerListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Owner xsi:type="organization">
   <Id>1</Id>
   <Name>System</Name>
   <Type>Organization</Type>
  </Owner>
  <Owner xsi:type="community">
   <Id>26</Id>
   <Name>Common Community</Name>
   <Type>Community</Type>
  </Owner>
 </Data>
</ownersResponse>
```

> View the Owner Organization for the current API User

```
GET /v2/owners/mine

Response:
{
    "status": "Success",
    "data": {
        "owner": {
            "id": 665,
            "name": "Acme Corp",
            "type": "Organization"
        }
    }
}
```

> View all Owners that are accessible to the current API User

```
GET /v2/owners

Response:
{
    "status": "Success",
    "resultCount": 2,
    "data": {
        "owner": 
        {
            "id": 665,
            "name": "Acme Corp",
            "type": "Organization"
        },
        {
            "id": 666,
            "name": "Ominous Corp",
            "type": "Organization"
        }
    }
}
```

> View all members of an Organization 

```
GET /v2/owners/mine/members

Response if Organization allows anonymous membership:
{
    “anonymous”: true,
    "status": "Success",
    "resultCount": 2,
    “members”:
    [
     “pseudonym”: “test”,
     “pseudonym”: “test2”
    ]
  
}

Response if Organization does not allow anonymous membership:
{
  “anonymous”: false, 
  "status": "Success",
  "resultCount": 2,
  “members”: [
      {
          “name”: “test”,
          “id”: “50”
      }, 
      {
          “name”: “test2”,
          “id”: “51”
      }
  ]
}
```

Depending on the member visibility of the Organization, results will include the member user's `name` and `id`, or only the member's `pseudonym`.

> The example below is of a request path with Owner query parameter for Indicators Collection:

```
/v2/indicators?owner=Common%20Community
```

> The example below is of a request path with Owner query parameter for Host Indicator baddomain.com:

```
/v2/indicators/hosts/baddomain.com?owner=Common%20Community
```

> The example below is a request to see available Owners of the specified Indicators:

```
/v2/indicators/hosts/baddomain.com/owners
```

> Threats Collection for the Common Community:

```
/v2/groups/threats?owner=Common%20Community
```

> Specific Threat (Owner implied by ID):

```
/v2/groups/threats/300
```

<b>Working with Owners</b>

The Owners service is a simple service that returns a Collection of Owners to which the API account has access. These Owners include the client’s Organization, as well as any Sources or Communities to which a client’s API User has been granted permission.

The ThreatConnect API allows querying data from a user’s Organization, or Communities to which the API account has access, as returned from the Owners Service. Queries to Collections of Indicators, Groups, and to specific Indicators allow the user to specify the Owner for which to query data. Specifying the Owner is done by appending an HTTP query parameter named "owner" onto the path of appropriate requests, with the value equal to the Name from the Owners Service. By default, all requests that do not include an Owner are assumed to be for the API User’s Organization.

Since Indicators are retrieved by their unique value, which will be the same in each Organization and Community, the Owner for both Collections and specific Indicator requests must be specified.

Clients who have access to an Indicator they would like to query, but who do not know if their Organization or any Community to which they have access has the Indicator, can request to see available Owners of the specified Indicators, as shown in the example below:

This action will return a list of Owners, if any, that have the baddomain host, to which the user has access.
When working with Groups, such as Incidents and Threats, only specify the Owner when retrieving the Collection, as a specific Group is retrieved by a unique ID.


NOTE: With the additional of write functionality to API V2, Owner roles have become increasingly important. For example, when creating or modifying Resources in a Community or Source, at least a Contributor-level access for that ownership Group must be held.

###Indicators Service

> Example Indicator Service Path:

```
/v2/indicators/hosts?resultStart=0&resultLimit=20
/v2/indicators/hosts?owner=Common%20Community&resultStart=0&resultLimit=20
```



The ThreatConnect API Indicators Service allows for the querying of a generic Collection of Indicators for a user’s Organization, as well as any Communities to which the user has access. 

> Note that the results will contain a mix of Indicator types, including variations, such as IPv4/IPv6 for addresses or MD5/SHA-1/SHA-256 for files. A list of Indicators from both the Groups and Tags Service can also be retrieved.

###Filtering Indicators

> The example below demonstrates usage of the modifiedSince parameter: 

```
/v2/indicators?modifiedSince=2014-08-01T12:00:00Z
```

> The example below demonstrates usage of the modifiedSince parameter and an additional parameter:

```
/v2/indicators?modifiedSince=2014-08-01T12:00:00Z&owner=Common%20Community
```

> The example below demonstrates usage of the summary parameter:

```
/v2/indicators?filters=summary=lmco.com
```

> The example below demonstrates usage of the rating parameter:

```
/v2/indicators?filters=rating%3E3
```

> The example below demonstrates usage of the threatAssessConfidence parameter:

```
/v2/indicators/urls?filters=threatAssessConfidence%3E50
```

> The example below demonstrates usage of the organization parameter:

```
/v2/indicators/addresses?filters=organization=mosso%20hosting
```

> The example below demonstrates usage of the whoisActive parameter:

```
/v2/indicators/hosts?filters=whoisActive=true
```

> The example below demonstrates usage of a Group name parameter:

```
/v2/groups?filters=name%5ETest
```

> The example below demonstrates usage of a Group fileType parameter:

```
/v2/groups/documents?filters=fileType=PDF
```

> The example below demonstrates usage of a securityLabels filter parameter:

```
/v2/securityLabels?filters=name=dictators
```

> The example below demonstrates usage of a victim filter parameter:

```
/v2/victims?filters=name%5ETest
```

> The example below demonstrates usage of a tag filter parameter:

```
/v2/tags?filters=weight%3E2
```

> The example below demonstrates usage multiple parameters (with implicit AND):

```
/v2/indicators?filters=summary=lmco.com,dateAdded%3C20151015
```

> The example below demonstrates usage multiple parameters (with parameters OR’ed):

```
/v2/indicators?filters=summary=lmco.com,dateAdded%3E20151015&orParams=true
```

To prevent the ThreatConnect API to return an entire resultset, limit the scope of the query based on the modifiedSince parameter. When a query from the list below is issued with this parameter, it will only return Indicators whose lastModified field contains a value on or after the time specified by the included ISO 8601 time-stamp.

Use the modifiedSince parameter on the Indicators Service, e.g., `/v2/indicators`

Note that the ISO 8601 time-stamp is in the same format used to display an Indicator’s lastModified value, and it can also be used in conjunction with other parameters.

Note that an Indicator’s lastModified field is used to determine whether or not it will be included with such a query. The following actions update an Indicator’s lastModified field:
- Creating the Indicator manually
- Importing the Indicator via structured or unstructured import
- Changing or resetting the Indicator’s "Threat" Rating
- Changing the Indicator’s Confidence value

<b>Table 3 - Filters</b> 

Name                           | Data Type  | Operators   | DB Field                   
-------------------------------|------------|-------------|----------------------------
<b>Indicator Common Filters</b>|            |             |
summary                        | String     | `= ^`       | indicator.summary          
dateAdded                      | Date       | `< >`       | indicator.dateAdded        
rating                         | BigDecimal | `<>`        | indicator.rating           
confidence                     | Short      | `=<>`       | indicator.confidence       
threatAssessRating             | Double     | `<>`        | commonIndicator.rating     
threatAssessConfidence         | Double     | `<>`        | commonIndicator.confidence 
<b>Address Specific Filters</b>|            |             |
countryCode                    | String     | `=`         | ipgeo.countryCode    
organization                   | String     | `=`         | ipgeo.registeringOrg 
asn                            | Integer    | `=`         | ipgeo.asn  
<b>Host Specific Filters</b>   |            |             |
whoisActive                    | Boolean    | `=`         | Indicator.flag2 on a host record 
dnsActive                      | Boolean    | `=`         | Indicator.flag1 on a host record 
<b>Groups Type Filters</b>     |            |             |
name                           | String     | `= ^`       | bucket.name      
dateAdded                      | Date       | `=<>`       | bucket.dateAdded 
<b>Groups Document Filter</b>  |            |             |
fileType                       | String     | `=`         | bucketDocument.type
<b>Security Label Specific Filter</b> |     |             |
name                           | String     | `= ^`       | securitylabel.name 
<b>Tag Specific Filter</b>     |            |             |
name                           | String     | `= ^`       | tag.name   
weight                         | Integer    | `=<>`       | tag.weight 
<b>Victim Specific Filter</b>  |            |             |
name                           | String     | `=  ^`      | victim.name 

<b>Note:</b> `<`, `>`, and `^` operators need to be escaped in the url as: `< %3C`, `> %3E`, `^ %5E`.

### Resource Types

Below is a list of all Resource Types and all HTTP paths for obtaining each Resource Type. The following tables list when pagination is required or if the specific path supports specifying an Owner. Note that if a path does not support the Owner argument, but one is supplied, the argument will simply be ignored. Detailed information on each of the Resource Types, as well as example responses, are available later in this document. Table 3 also references multiple Indicator and Group types. Currently, these are the supported types for each entity:

<b>Indicators</b>: `/v2/indicators/`

- Addresses: `/v2/indicators/addresses/`
- Email Addresses: `/v2/indicators/emailAddresses/`
- Hosts: `/v2/indicators/hosts/`
- Urls: `/v2/indicators/urls/`
- Files: `/v2/indicators/files/`

<b>Groups</b>: `/v2/groups/`

- Adversaries: `/v2/groups/adversaries/`
- Documents: `/v2/groups/documents/`
- Emails: `/v2/groups/emails/`
- Incidents: `/v2/groups/incidents/`
- Signatures: `/v2/groups/signatures/`
- Threats: `/v2/groups/threats/`

<b>Other</b>

- Victims: `/v2/victims/`
- Tasks: `/v2/tasks/`
- Tags: `/v2/tags/`

####Indicators Resource Type

> Indicators Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "indicator": [{
   "id": 6574,
   "ownerName": "Organization Name",
   "type": "Host",
   "dateAdded": "2013-11-20T01:13:12Z",
   "lastModified": "2013-11-20T01:13:12Z",
   "confidence": 0,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&owner=Organization+Name",
   "description": "Host Description",
   "summary": "test.com"
  }, {
   "id": 199,
   "ownerName": "Organization Name",
   "type": "File",
   "dateAdded": "2013-08-21T14:14:42Z",
   "lastModified": "2013-08-21T14:14:42Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=A35A766A9F881A8E6B01BBBC0D6BE829&owner=Organization+Name",
   "summary": "A35A766A9F881A8E6B01BBBC0D6BE829"
  }]
 }
}
```

> Indicators Resource Type XML Response:

```xml
<indicatorsResponse>
 <Status>Success</Status>
 <Data xsi:type="indicatorListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Indicator>
   <Id>6574</Id>
   <OwnerName>Organization Name</OwnerName>
   <Type>Host</Type>
   <DateAdded>2013-11-20T01:13:12Z</DateAdded>
   <LastModified>2013-11-20T01:13:12Z</LastModified>
   <Confidence>0</Confidence>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&amp;owner=Organization+Name</WebLink>
   <Description>Host Description</Description>
   <Summary>test.com</Summary>
  </Indicator>
  <Indicator>
   <Id>199</Id>
   <OwnerName>Organization Name</OwnerName>
   <Type>File</Type>
   <DateAdded>2013-08-21T14:14:42Z</DateAdded>
   <LastModified>2013-08-21T14:14:42Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=A35A766A9F881A8E6B01BBBC0D6BE829&amp;owner=Organization+Name</WebLink>
   <Summary>A35A766A9F881A8E6B01BBBC0D6BE829</Summary>
  </Indicator>
 </Data>
</indicatorsResponse>
```

<b>Table 4 - Indicators Resource Type</b>

 Paths                                                 | Owner <br> Allowed | Pagination <br> Required |
-------------------------------------------------------|---------------|------
`/v2/indicators`                                       | TRUE          | TRUE 
`/v2/groups/<group type>/<ID>/indicators`              | FALSE         |      
`/v2/tags/<tag name>/indicators`                       | TRUE          |       
`/v2/securityLabels/<security label name>/indicators`  | TRUE          |       
`/v2/victims/<ID>/indicators`                          | FALSE         |     
`/v2/tasks/<ID>/indicators`                          | TRUE         |     

####Hosts Resource Type

> Hosts Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "host": [{
   "id": 6574,
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T01:13:12Z",
   "lastModified": "2013-11-20T01:13:12Z",
   "confidence": 0,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&owner=Organization+Name",
   "description": "Host Description",
   "hostName": "test.com"
  }, {
   "id": 197,
   "ownerName": "Organization Name",
   "dateAdded": "2013-08-21T11:31:41Z",
   "lastModified": "2013-08-21T11:31:41Z",
   "rating": 4,
   "confidence": 44,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=baddomain.com&owner=Organization+Name",
   "hostName": "baddomain.com"
  }]
 }
}
```

> Hosts Resource Type XML Response:

```xml
<hostsResponse>
 <Status>Success</Status>
 <Data xsi:type="hostListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Host>
   <Id>6574</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T01:13:12Z</DateAdded>
   <LastModified>2013-11-20T01:13:12Z</LastModified>
   <Confidence>0</Confidence>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&amp;owner=Organization+Name</WebLink>
   <Description>Host Description</Description>
   <HostName>test.com</HostName>
  </Host>
  <Host>
   <Id>197</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-08-21T11:31:41Z</DateAdded>
   <LastModified>2013-08-21T11:31:41Z</LastModified>
   <Rating>4.00</Rating>
   <Confidence>44</Confidence>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=baddomain.com&amp;owner=Organization+Name</WebLink>
   <HostName>baddomain.com</HostName>
  </Host>
 </Data>
</hostsResponse>
```

A list of Hosts from both the Groups and Tags Service can be retrieved, as detailed in Table 4.

<b>Table 5 - Hosts Resource Type</b>

 Paths                                                      | Owner <br> Allowed | Pagination <br> Required
------------------------------------------------------------|---------------|---------------------
`/v2/indicators/hosts`                                      | TRUE          | TRUE
`/v2/groups/<group type>/<ID>/indicators/hosts`             | FALSE         |  
`/v2/tags/<tag name>/indicators/hosts`                      | TRUE          |  
`/v2/securityLabels/<security label name>/indicators/hosts` | TRUE          |  
`/v2/victims/<ID>/indicators/hosts`                         | FALSE         |  

####Host Resource Type

> Example of Indicator Service query for a specific Host for a user’s Organization:

```
/v2/indicators/hosts/baddomain.com
```

> Example of an Indicator Service query for a speific Host to the Communities to which a user has access:

```
/v2/indicators/hosts/baddomain.com?owner=Common%20Community
```

> Host Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "host": {
   "id": 6574,
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T01:13:12Z",
   "lastModified": "2013-11-20T01:13:12Z",
   "confidence": 0,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&owner=Organization+Name",
   "description": "Host Description",
   "hostName": "test.com",
   "dnsActive": "false",
   "whoisActive": "false"
  }
 }
}
```

> Host Resource Type XML Response:

```xml
<hostResponse>
 <Status>Success</Status>
 <Data xsi:type="hostResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Host>
   <Id>6574</Id>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T01:13:12Z</DateAdded>
   <LastModified>2013-11-20T01:13:12Z</LastModified>
   <Confidence>0</Confidence>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=test.com&amp;owner=Organization+Name</WebLink>
   <Description>Host Description</Description>
   <HostName>test.com</HostName>
   <DnsActive>false</DnsActive>
   <WhoisActive>false</WhoisActive>
  </Host>
 </Data>
</hostResponse>
```

The Indicators Service allows for the querying of a specific Host for a user’s Organization, as well as any Communities to which a user has access.

<b>Table 6 - Host Resource Type</b>

Paths                             | Owner <br> Allowed | Pagination <br> Required
----------------------------------|---------------|--------------------
`/v2/indicators/hosts/<hostname>` | TRUE          | FALSE   

For each Host, its Attributes, DNS Resolutions, associated Groups, Tags, Security Labels, Victims, Victim Assets, and available Owners can also be retrieved.

####Retrieving Host DNS Resolutions

> Example of DNS History request for a Host within an Organization:

```
/v2/indicators/hosts/baddomain.com/dnsResolutions
```

> Example of DNS History request for a Host within a Community:

```
/v2/indicators/hosts/baddomain.com/dnsResolutions?owner=Common%20Community
```

> DNSResolutions Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "dnsResolution": [{
   "resolutionDate": "2017-01-30T20:49:05Z",
   "addresses": [{
    "id": 123456,
    "ownerName": "Organization Name",
    "dateAdded": "2017-01-20T20:49:05Z",
    "lastModified": "2017-01-27T20:49:05Z",
    "threatAssessRating": 3.0,
    "threatAssessConfidence": 50.0,
    "webLink": "https://demo.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.100.1&owner=Organization+Name",
    "ip": "192.168.100.1"
   }]
  }]
 }
}
```

> DNSResolutions Resource Type XML Response:

```xml
<dnsResolutionsResponse>
 <Status>Success</Status>
 <Data xsi:type="dnsResolutionListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>1</ResultCount>
  <DnsResolution>
   <ResolutionDate>2013-11-18T13:27:35Z</ResolutionDate>
   <Addresses>
    <Id>123456</Id>
    <OwnerName>Organization Name</OwnerName>
    <DateAdded>2017-01-20T20:49:05Z</DateAdded>
    <LastModified>2017-01-27T20:49:05Z</LastModified>
    <ThreatAssessRating>3.0</ThreatAssessRating>
    <ThreatAssessConfidence>50.0</ThreatAssessConfidence>
    <WebLink>https://demo.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.100.1&amp;owner=Organization+Name</WebLink>
    <Ip>192.168.100.1</Ip>
   </Addresses>
  </DnsResolution>
 </Data>
</dnsResolutionsResponse>
```

####Addresses Resource Type

> Example of an Indicators Service query for a Collection of Addresses for a user's organization:

```
/v2/indicators/addresses?resultStart=0&resultLimit=20
```

> Example of an Indicator Service query for a Collection of Addresses to the Communities to which a user has access:

```
/v2/indicators/addresses?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of an Indicators Service query for a specific Address for a user's Organization:

```
/v2/indicators/addresses/192.168.1.1
```

> Example of an Indicator Service query for a specific Address to the Communities to which a user has access:

```
/v2/indicators/addresses/d24c:3256:0:0:0:0:0:2701?owner=Common%20Community
```

> Addresses Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "address": [{
   "id": 6710,
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T14:53:51Z",
   "lastModified": "2013-12-22T14:53:51Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.1.1&owner=Organization Name",
   "ip": "192.168.1.1"
  }, {
   "id": 198,
   "ownerName": "Organization Name",
   "dateAdded": "2013-08-21T12:58:49Z",
   "lastModified": "2013-08-21T12:58:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=d24c:3256:0:0:0:0:0:2701&owner=Organization Name",
   "ip": "d24c:3256:0:0:0:0:0:2701"
  }]
 }
}
```

> Addresses Resource Type XML Response:

```xml
<addressesResponse>
 <Status>Success</Status>
 <Data xsi:type="addressListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Address>
<Id>6710</Id>
<OwnerName>Organization Name</OwnerName>
<DateAdded>2013-12-22T14:53:51Z</DateAdded>
<LastModified>2013-12-22T14:53:51Z</LastModified>
<WebLink>https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.1.1&amp;owner=Organization Name</WebLink>
<Address>192.168.1.1</Address>
  </Address>
  <Address>
<Id>198</Id>
<OwnerName>Organization Name</OwnerName>
<DateAdded>2013-08-21T12:58:49Z</DateAdded>
<LastModified>2013-08-21T12:58:49Z</LastModified>
<WebLink>https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=d24c:3256:0:0:0:0:0:2701&amp;owner=Organization Name</WebLink>
<Address>d24c:3256:0:0:0:0:0:2701</Address>
  </Address>
 </Data>
</addressesResponse>
```

The Indicators Service allows for the querying of a Collection of Addresses for a user’s Organizations, as well as any Communities to which a user has access. Both IPv4 and IPv6 address types are supported, both with queries and as possible results, in the "ip" field.

A list of Addresses from both the Groups and Tags Service, as detailed in Table 6, may also be retrieved.

<b>Table 7 - Addresses Resource Type</b>

Paths                                                           | Owner <br> Allowed | Pagination <br> Required
----------------------------------------------------------------|---------------|---------------------
`/v2/indicators/addresses`                                      | TRUE          | TRUE                
`/v2/groups/<group type>/<ID>/indicators/addresses`             | FALSE         |                     
`/v2/tags/<tag name>/indicators/addresses`                      | TRUE          |                     
`/v2/securityLabels/<security label name>/indicators/addresses` | TRUE          |                     
`/v2/victims/<ID>/indicators/addresses`                         | FALSE         |  

The Indicators Service allows for the querying of a specific Address for a user’s Organization, as well as any Communities to which a user has access:

####Address Resource Type

> Address Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "address": {
   "id": 198,
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-08-21T12:58:49Z",
   "lastModified": "2013-08-21T12:58:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.1.1&owner=Organization Name",
   "ip": "192.168.1.1"
  }
 }
}
```

> Address Resource TypeXML Response:

```xml
<addressResponse>
 <Status>Success</Status>
 <Data xsi:type="addressResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Address>
<Id>198</Id>
<Owner xsi:type="organization">
<Id>1</Id>
<Name>Organization Name</Name>
<Type>Organization</Type>
</Owner>
<DateAdded>2013-08-21T12:58:49Z</DateAdded>
<LastModified>2013-08-21T12:58:49Z</LastModified>
<WebLink>https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.1.1&amp;owner=Organization Name</WebLink>
<Address>192.168.1.1</Address>
  </Address>
 </Data>
</addressResponse>
```

<b>Table 8 - Address Resource Type</b>

Paths                                | Owner <br> Allowed | Pagination <br> Required
-------------------------------------|---------------|---------------------
`/v2/indicators/addresses/<address>` | TRUE          | FALSE      

For each Address, its Attributes, DNS Resolutions, associated Groups, Tags, Security Labels , Victims , Victim Assets , and available Owners can also be retrieved.

####Retrieving Address DNS Resolutions

> Example of DNS History request for an Address within an Organization:

```
/v2/indicators/addresses/192.168.0.1/dnsResolutions
```

> Example of DNS History request for an Address within a Community:

```
/v2/indicators/addresses/192.168.0.1/dnsResolutions?owner=Common%20Community
```

> DNSResolutions Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "indicator": [{
   "id": 123456,
   "ownerName": "Organization Name",
   "type": "Host",
   "dateAdded": "2015-07-02T17:45:32Z",
   "lastModified": "2017-01-06T18:17:52Z",
   "rating": 5.00,
   "confidence": 85,
   "threatAssessRating": 4.36,
   "threatAssessConfidence": 80.67,
   "webLink": "https://demo.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=bad.com&owner=Organization+Name",
   "description": "Host retrieved from malware analysis.",
   "summary": "bad.com"
   }
  ]
 }
}
```

> DNSResolutions Resource Type XML Response:

```xml
<dnsResolutionsResponse>
 <Status>Success</Status>
 <Data xsi:type="dnsResolutionListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>1</ResultCount>
  <Indicator>
    <Id>123456</Id>
    <OwnerName>Organization Name</OwnerName>
    <Type>Host</Type>
    <DateAdded>2015-07-02T17:45:32Z</DateAdded>
    <LastModified>2017-01-06T18:17:52Z</LastModified>
    <Rating>5.00</Rating>
    <Confidence>85</Confidence>
    <ThreatAssessRating>4.36</ThreatAssessRating>
    <ThreatAssessConfidence>80.67</ThreatAssessConfidence>
    <WebLink>https://demo.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=bad.com&amp;owner=Organization+Name</WebLink>
    <Summary>bad.com</Summary>
  </Indicator>
 </Data>
</dnsResolutionsResponse>
```

####Files Resource Type

> Example of an Indicators Service query for a Collection of Files for a user's organization:

```
/v2/indicators/files?resultStart=0&resultLimit=20
```

> Example of an Indicator Service query for a Collection of Files to the Communities to which a user has access:

```
/v2/indicators/files?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of an Indicators Service query for a Collection of Files for a user's organization:

```
/v2/indicators/files/A35A766A9F881A8E6B01BBBC0D6BE829
```

> Example of an Indicator Service query for a Collection of Files to the Communities to which a user has access:

```
/v2/indicators/files/A35A766A9F881A8E6B01BBBC0D6BE829?owner=Common%20Community
```

> Files Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 3,
  "file": [{
   "id": 258116,
   "ownerName": "Organization Name",
   "dateAdded": "2014-08-11T19:12:10-04:00",
   "lastModified": "2014-08-11T19:12:36-04:00",
   "rating": 4.0,
   "confidence": 81,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=222C230AE1C601AE0D125445BAB9728989AADDDA&owner=Organization Name",
   "sha1": "222C230AE1C601AE0D125445BAB9728989AADDDA"
  }, {
   "id": 258117,
   "ownerName": "ThreatConnect-IRT",
   "dateAdded": "2014-08-11T19:12:10-04:00",
   "lastModified": "2014-08-11T19:12:36-04:00",
   "rating": 4.0,
   "confidence": 81,
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=222DF09B9CC2994B1C8CB254E1BBD2D9EEDD1916AF0BBAA95F5A3DFF6E2A499C&owner=Organization Name",
   "sha256": "222DF09B9CC2994B1C8CB254E1BBD2D9EEDD1916AF0BBAA95F5A3DFF6E2A499C"
  }, {
   "id": 258115,
   "ownerName": "ThreatConnect-IRT",
   "dateAdded": "2014-08-11T19:12:09-04:00",
   "lastModified": "2014-08-11T19:12:36-04:00",
   "rating": 4.0,
   "confidence": 81,
   "webLink": " https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=22202B566A725038BA2423C86B584428&owner=Organization Name",
   "md5": "22202B566A725038BA2423C86B584428"
  }]
 }
}
```

> Files Resource Type XML Response:

```xml
<filesResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="fileListResponseData">
  <ResultCount>3</ResultCount>
  <File>
   <Id>258116</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2014-08-11T19:12:10-04:00</DateAdded>
   <LastModified>2014-08-11T19:12:36-04:00</LastModified>
   <Rating>4.00</Rating>
   <Confidence>81</Confidence>
   <WebLink> https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=222C230AE1C601AE0D125445BAB9728989AADDDA&owner=Organization Name</WebLink>
   <sha1>222C230AE1C601AE0D125445BAB9728989AADDDA</sha1>
  </File>
  <File>
   <Id>258117</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2014-08-11T19:12:10-04:00</DateAdded>
   <LastModified>2014-08-11T19:12:36-04:00</LastModified>
   <Rating>4.00</Rating>
   <Confidence>81</Confidence>
   <WebLink> https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=222DF09B9CC2994B1C8CB254E1BBD2D9EEDD1916AF0BBAA95F5A3DFF6E2A499C&owner=Organization Name</WebLink>
   <sha256>222DF09B9CC2994B1C8CB254E1BBD2D9EEDD1916AF0BBAA95F5A3DFF6E2A499C</sha256>
  </File>
  <File>
   <Id>258115</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2014-08-11T19:12:09-04:00</DateAdded>
   <LastModified>2014-08-11T19:12:36-04:00</LastModified>
   <Rating>4.00</Rating>
   <Confidence>81</Confidence>
   <WebLink> https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=22202B566A725038BA2423C86B584428&owner=Organization Name</WebLink>
   <md5>22202B566A725038BA2423C86B584428</md5>
  </File>
 </Data>
</filesResponse>
```

The Indicators Service allows for the querying of a Collection of Files for a user’s Organization, as well as any Communities to which a user has access. 

A list of Files from both the Groups and Tags Service, as detailed in Table 8, can also be retrieved.

<b>Table 9 - Files Resource Type</b>

Paths                                                       | Owner <br> Allowed | Pagination <br> Required 
------------------------------------------------------------|---------------|---------------------
`/v2/indicators/files`                                      | TRUE          | TRUE                
`/v2/groups/<group type>/<ID>/indicators/files`             | FALSE         |                     
`/v2/tags/<tag name>/indicators/files`                      | TRUE          |                     
`/v2/securityLabels/<security label name>/indicators/files` | TRUE          |                     
`/v2/victims/<ID>/indicators/files`                         | FALSE         |                     
 
The Files Resource Type response format is to the right. Note that with support for additional hash types, the Files response format may return files identified by "md5," "sha1," or "sha256." It may also return multiple records, one for each hash, even if they represent the same file.

The Indicators Service allows for the querying of a specific File for a user’s Organization, as well as any Communities to which a user has access:.

####File Resource Type

> File Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "file": {
   "id": 199,
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-08-21T14:14:42Z",
   "lastModified": "2013-08-21T14:14:42Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=A35A766A9F881A8E6B01BBBC0D6BE829&owner=Organization Name",
   "md5": "A35A766A9F881A8E6B01BBBC0D6BE829",
   "sha1": "9F8CC0A150D272D9393F86B5F5F2D1265E8917D1",
   "sha256": "B4C1E9C99F861A4DD7654DCC3548AB5DDC15EE5FEB9690B9F716C4849714B20D"
  }
 }
}
```

> File Resource Type XML Response:

```xml
<fileResponse>
 <Status>Success</Status>
 <Data xsi:type="fileResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <File>
   <Id>199</Id>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-08-21T14:14:42Z</DateAdded>
   <LastModified>2013-08-21T14:14:42Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/file.xhtml?file=A35A766A9F881A8E6B01BBBC0D6BE829&amp;owner=Organization Name</WebLink>
   <md5>A35A766A9F881A8E6B01BBBC0D6BE829</md5>
   <sha1>9F8CC0A150D272D9393F86B5F5F2D1265E8917D1</sha1>
   <sha256>B4C1E9C99F861A4DD7654DCC3548AB5DDC15EE5FEB9690B9F716C4849714B20D</sha256>
  </File>
 </Data>
</fileResponse>
```

<b>Table 10 - File Resource Type</b>

Paths                                        | Owner <br> Allowed | Pagination <br> Required
---------------------------------------------|---------------|---------------------
`/v2/indicators/files/<hash>`                | TRUE          | FALSE                   

The File Resource Type response format is to the right. Note that any valid MD5, SHA-1, or SHA-256 hash in the system may be supplied. If found, the response will also include all linked hashes as below. Also note that the File response may include only a subset (i.e., only MD5 and SHA-1), if those are the only known connections in the system.

For each File, its Attributes, associated Groups, Tags, Security Labels , Victims , Victim Assets , and available Owners can be retrieved.

####FileOccurrence Resource Type

> FileOccurrence Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "fileOccurrence": [{
   "id": 9722,
   "fileName": "badguy.dll",
   "path": "C:\\Windows\\System32",
   "date": "2014-11-05T00:00:00Z"
  }]
 }
}
```

> FileOccurrence Resource Type XML Response:

```xml
<FileOccurrence>
 <Id>9722</Id>
 <FileName>badguy.dll </FileName>
 <Path> C:\Windows\System32</Path>
 <Date>2014-11-05T00:00:00Z</Date>
</FileOccurrence>
```

<b>Table 11 - FileOccurrence Resource Type</b>

For each File, its File Occurrences can be retrieved from a separate service.

Paths                                        | Owner <br> Allowed | Pagination <br> Required
---------------------------------------------|---------------|---------------------
`/v2/indicators/files/<hash>/fileOccurrences`| TRUE          | FALSE               

 
####emailAddresses Resource Type

> Example of an Indicators Service query for a Collection of Email Addresses for a user's organization:

```
/v2/indicators/emailAddresses?resultStart=0&resultLimit=20
```

> Example of an Indicator Service query for a Collection of Email Addresses to the Communities to which a user has access:

```
/v2/indicators/emailAddresses?owner=Common%20Community&resultStart=0&resultLimit=20
```

> emailAddresses Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "emailAddress": [{
   "id": 6711,
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T15:56:36Z",
   "lastModified": "2013-12-22T15:56:36Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@baddomain.com&owner=Organization Name",
   "address": "test@baddomain.com"
  }, {
   "id": 6575,
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T16:05:52Z",
   "lastModified": "2013-11-20T16:05:52Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@test.com&owner=Organization Name",
   "address": "test@test.com"
  }]
 }
}
```

> emailAddresses Resource Type XML Response:

```xml
<emailAddressesResponse>
 <Status>Success</Status>
 <Data xsi:type="emailAddressListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <EmailAddress>
   <Id>6711</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T15:56:36Z</DateAdded>
   <LastModified>2013-12-22T15:56:36Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@baddomain.com&amp;owner=Organization Name</WebLink>
   <Address>test@baddomain.com</Address>
  </EmailAddress>
  <EmailAddress>
   <Id>6575</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T16:05:52Z</DateAdded>
   <LastModified>2013-11-20T16:05:52Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@test.com&amp;owner=Organization Name</WebLink>
   <Address>test@test.com</Address>
  </EmailAddress>
 </Data>
</emailAddressesResponse>
```

The Indicators Service allows for the querying of a Collection of Email Addresses for a user’s Organization, as well as any Communities to which a user has access: 

A list of Email Addresses from both the Groups and Tags Service, as detailed in Table 11, can be retrieved.

<b>Table 12 - Email Addresses Resource Type</b>

Paths                                                                | Owner <br> Allowed | Pagination <br> Required
---------------------------------------------------------------------|---------------|---------------------
`/v2/indicators/emailAddresses`                                      | TRUE          | TRUE                
`/v2/groups/<group type>/<ID>/indicators/emailAddresses`             | FALSE         |                     
`/v2/tags/<tag name>/indicators/emailAddresses`                      | TRUE          |                     
`/v2/securityLabels/<security label name>/indicators/emailAddresses` | TRUE          |                     
`/v2/victims/<ID>/indicators/emailAddresses`                         | FALSE         |                     

####emailAddress Resource Type

> Example of an Indicators Service query for a Collection of Email Addresses for a user's organization:

```
/v2/indicators/emailAddresses/test@baddomain.com
```

> Example of an Indicator Service query for a Collection of Email Addresses to the Communities to which a user has access:

```
/v2/indicators/emailAddresses/test@baddomain.com?owner=Common%20Community
```

> emailAddress Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "emailAddress": {
   "id": 6575,
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T16:05:52Z",
   "lastModified": "2013-11-20T16:05:52Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@test.com&owner=Organization Name",
   "address": "test@test.com"
  }
 }
}
```

> emailAddress Resource Type XML Response:

```xml
<emailAddressResponse>
 <Status>Success</Status>
 <Data xsi:type="emailAddressResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <EmailAddress>
   <Id>6575</Id>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T16:05:52Z</DateAdded>
   <LastModified>2013-11-20T16:05:52Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/emailaddress.xhtml?emailaddress=test@test.com&amp;owner=Organization Name</WebLink>
   <Address>test@test.com</Address>
  </EmailAddress>
 </Data>
</emailAddressResponse>
```

The Indicators Service allows for the querying of a specific Email Address for a user’s Organization, as well as any Communities to which a user has access:

<b>Table 13 - emailAddress Resource Type</b>

Paths                                           | Owner <br> Allowed | Pagination <br> Required
------------------------------------------------|---------------|---------------------
`/v2/indicators/emailAddresses/<email address>` | TRUE          | FALSE               

For each Email Address, its Attributes, associated Groups, Tags, Security Labels , Victims , Victim Assets , and available Owners can be retrieved.

####urls Resource Type

> Indicator Service query for a Collection of URLs from a user's Organization:

```
/v2/indicators/urls?resultStart=0&resultLimit=20
```

> Indicator Service query for a Collection of URLs from a user's Organization:

```
/v2/indicators/urls?owner=Common%20Community&resultStart=0&resultLimit=20
```

> urls Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "url": [{
   "id": 6712,
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T16:08:21Z",
   "lastModified": "2013-12-22T16:08:21Z",
   "webLink": "https://demo.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http%3A%2F%2Fbaddomain.com%2Fsomepath&owner=Organization+Name",
   "text": "http://baddomain.com/somepath"
  }, {
   "id": 6576,
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T16:07:17Z",
   "lastModified": "2013-11-20T16:07:17Z",
   "webLink": "https://demo.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http%3A%2F%2Ftest.com&owner=Organization+Name",
   "text": "http://test.com"
  }]
 }
}
```

> urls Resource Type XML Response:

```xml
<urlsResponse>
 <Status>Success</Status>
 <Data xsi:type="urlListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Url>
   <Id>6712</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T16:08:21Z</DateAdded>
   <LastModified>2013-12-22T16:08:21Z</LastModified>
   <WebLink>https://demo.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http%3A%2F%2Fbaddomain.com%2Fsomepath&amp;owner=Organization+Name</WebLink>
   <Text>http://baddomain.com/somepath</Text>
  </Url>
  <Url>
   <Id>6576</Id>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T16:07:17Z</DateAdded>
   <LastModified>2013-11-20T16:07:17Z</LastModified>
   <WebLink>https://demo.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http%3A%2F%2Ftest.com&amp;owner=Organization+Name</WebLink>
   <Text>http://test.com</Text>
  </Url>
 </Data>
</urlsResponse>
```

The Indicators Service allows for the querying of a Collection of URLs for a user’s Organization, as well as any Communities to which a user has access: 

A list of URLs from both the Groups and Tags Service, as detailed in Table 13, can be retrieved.

<b>Table 14 - urls Resource Type</b>

Paths                                                      | Owner <br> Allowed | Pagination <br> Required
-----------------------------------------------------------|---------------|---------------------
`/v2/indicators/urls`                                      | TRUE          | TRUE                
`/v2/groups/<group type>/<ID>/indicators/urls`             | FALSE         |                     
`/v2/tags/<tag name>/indicators/urls`                      | TRUE          |                     
`/v2/securityLabels/<security label name>/indicators/urls` | TRUE          |                     
`/v2/victims/<ID>/indicators/urls`                         | FALSE         |                     

####url Resource Type

> Indicator Service query for a Collection of URLs from a user's Organization:

```
/v2/indicators/urls/http%3A%2F%2Ftest.com
```

> Indicator Service query for a Collection of URLs from a user's Organization:

```
/v2/indicators/urls/http%3A%2F%2Ftest.com?owner=Common%20Community
```

> url Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "url": {
   "id": 6576,
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T16:07:17Z",
   "lastModified": "2013-11-20T16:07:17Z",
   "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http://test.com&owner=Organization Name",
   "text": "http://test.com"
  }
 }
}
```

> url Resource Type XML Response:

```xml
<urlResponse>
 <Status>Success</Status>
 <Data xsi:type="urlResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Url>
   <Id>6576</Id>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T16:07:17Z</DateAdded>
   <LastModified>2013-11-20T16:07:17Z</LastModified>
   <WebLink>https://app.threatconnect.com/tc/auth/indicators/details/url.xhtml?url=http://test.com&amp;owner=Organization Name</WebLink>
   <Text>http://test.com</Text>
  </Url>
 </Data>
</urlResponse>
```

The Indicators Service allows for the querying of a specific URL for a user’s Organization, as well as any Communities to which a user has access:

<b>Table 15 - URL Resource Type</b>

Paths                       | Owner <br> Allowed | Pagination <br> Required
----------------------------|---------------|---------------------
`/v2/indicators/urls/<url>` | TRUE          | FALSE           

For each URL, its Attributes, associated Groups, Tags, Security Labels , Victims , Victim Assets , and available Owners can be retrieved.

###Observations

> Show total number of observations for a given Indicator (with timestamps)
`GET /v2/indicators/[IndicatorType]/[IndicatorName]/observations`

> Response data (note: if `resultCount` is 0 there are no observations and response[data][observation] will be an empty list)

```json
{
  "status" : "Success",
  "data" : {
    "resultCount" : 2,
    "observation" : [ {
      "count" : 5,
      "dateObserved" : "2016-03-18T10:04:31-04:00"
    }, {
      "count" : 7,
      "dateObserved" : "2016-03-18T10:15:13-04:00"
    } ]
  }
}
```

> Show full details of observations for a given Indicator

`GET /v2/indicators/[IndicatorType]/[IndicatorName]/observations?includeAdditional=true`

> Response data

```json
{
  "status" : "Success",
  "data" : {
    "host" : {
      "id" : 1,
      "owner" : {
        "id" : 2,
        "name" : "Acme",
        "type" : "Organization"
      },
      "dateAdded" : "2016-02-02T17:50:25-05:00",
      "lastModified" : "2016-02-02T17:50:25-05:00",
      "webLink" : "https://……..",
      "observationCount" : 5,
      "lastObserved" : "2016-02-04T11:28:23-05:00",
      "falsePositiveCount" : 1,
      "falsePositiveLastReported" : "2016-02-04T00:00:00-05:00",
      "hostName" : "….",
      "dnsActive" : "false",
      "whoisActive" : "false"
    }
  }
}
```

> Update the observation count for a given Indicator in your Organization

```
POST /v2/indicators/[IndicatorType]/[IndicatorName]/observations

{
"count" : 10
}
```

> Update the observation count for a given Indicator [in a Community or Source you have access to](http://docs.threatconnect.com/#owners-service)

```
POST /v2/indicators/[IndicatorType]/[IndicatorName]/observations?owner=[owner_name]

{
"count" : 10
}
```

Observations are reported via the API for a particular Indicator.

To add Observation data to the generic Indicators Resource Type response format, append the includeAdditional flag. and set it to ‘true’ in the query portion of the URL. By default, the includeAdditional flag is set to ‘false’. The includeAdditional field accepts ‘true’ or ‘false’.

When an API user issues a POST to the /observations branch of the API, if an observation record already exists it will add the new Observation count to the existing one. If it does not find a record, then it will create a new Observation. No entity is returned to the API user—only a 204 response, if successful. 

###Indicator Activity

###Indicator Activity


> Set API to return `inactive` results as well

```
POST /api/v2/indicators/[IndicatorType]/[IndicatorName]?includeInactive=true
```

> Set API to ignore (not return) `inactive` results

```
POST /api/v2/indicators/[IndicatorType]/[IndicatorName]?includeActive=true
```

> Reset the `active` flag on an Indicator import:

```
POST /api/v2/indicators/[IndicatorType]/[IndicatorName]?active=true
```

Each Owner (Organization, Community, or Source) will have the option to reset the active flag on an Indicator import. When this flag is set to ‘true’, Indicators that are automatically imported into the system (Bulk API, Source Feed, Email Ingest, etc.) will also have their active flags set to ‘true’. The active field accepts ‘true’ or ‘false’.

By default, inactive Indicators are not returned through the API when getting a list of indicators. Additional filters are supported for includeActive and includeInactive. These flags allow an integration to specify if it wants active or inactive data. The includeActive and includeInactive fields both accept ‘true’ or ‘false’.

Each Owner (Organization, Community, or Source) will have the option to reset the active flag on an Indicator import. When this flag is set to ‘true’, Indicators that are automatically imported into the system (Bulk API, Source Feed, Email Ingest, etc.) will also have their active flags set to ‘true’. The active field accepts ‘true’ or ‘false’.

By default, inactive Indicators are not returned through the API when getting a list of indicators. Additional filters are supported for includeActive and includeInactive. These flags allow an integration to specify if it wants active or inactive data. The includeActive and includeInactive fields both accept ‘true’ or ‘false’.

###False Positives

> Report a given Indicator as a False Positive:

```
POST v2/indicators/[IndicatorType]/[IndicatorName]/falsePositive

```

> Sample query with includeAdditional flag (e.g. /v2/indicators/[IndicatorType]/[IndicatorName]?includeAdditional=true):

```json
{
  "status" : "Success",
  "data" : {
    "host" : {
      "id" : 1,
      "owner" : {
        "id" : 2,
        "name" : "Acme",
        "type" : "Organization"
      },
      "dateAdded" : "2016-02-02T17:50:25-05:00",
      "lastModified" : "2016-02-02T17:50:25-05:00",
      "webLink" : "https://……..",
      "observationCount" : 5,
      "lastObserved" : "2016-02-04T11:28:23-05:00",
      "falsePositiveCount" : 1,
      "falsePositiveLastReported" : "2016-02-04T00:00:00-05:00",
      "hostName" : "….",
      "dnsActive" : "false",
      "whoisActive" : "false"
    }
  }
}
```

> Sample Query without includeAdditional flag (e.g. v2/indicators/[IndicatorType]/[IndicatorName]):

```json
{
  "status" : "Success",
  "data" : {
    "host" : {
      "id" : 1,
      "owner" : {
        "id" : 2,
        "name" : "Acme",
        "type" : "Organization"
      },
      "dateAdded" : "2016-02-02T17:50:25-05:00",
      "lastModified" : "2016-02-02T17:50:25-05:00",
      "webLink" : "https://……..",
      "hostName" : "….",
      "dnsActive" : "false",
      "whoisActive" : "false"
    }
  }
}
```

The API provides a mechanism for reporting False Positives. When submitting a PUT or POST to a specific Indicator, the falsePositive flag can be included as a field within the Indicator object. This will be a Boolean field of either ‘true’ or ‘false’.

Within the API, Indicator entities only return the falsePositiveCount and falsePositiveLastReported dates when the includeAdditional flag is set to ‘true’.

###ThreatAssess 

> ThreatAsses Score JSON Response:

```json
{
 "address": {
  "id": 73011,
  "owner": {
   "id": 631,
   "name": "Common Community",
   "type": "Community"
  },
  "dateAdded": "2013-07-27T22:14:56Z",
  "lastModified": "2013-07-27T22:14:56Z",
  "rating": 4.0,
  "confidence": 100,
  "threatAssessRating": 4.02,
  "threatAssessConfidence": 99.75,
  "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.0.1",
  "ip": "192.168.0.1"
 }
}
```

> ThreatAsses Score XML Response:

```xml
<Address>
<Id>73011</Id>
<Owner xsi:type="community">
<Id>631</Id>
<Name>Common Community</Name>
<Type>Community</Type>
</Owner>
<DateAdded>2013-07-27T22:14:56Z</DateAdded>
<LastModified>2013-07-27T22:14:56Z</LastModified>
<Rating>4.00</Rating>
<Confidence>100</Confidence>
<ThreatAssessRating>4.02</ThreatAssessRating>
<ThreatAssessConfidence>99.75</ThreatAssessConfidence>
<WebLink>https://app.threatconnect.com/tc/auth/indicators/details/address.xhtml?address=192.168.0.1 </WebLink>
<Address>192.168.0.1</Address>
</Address>
```

The ThreatConnect platform may or may not return fields associated to the ThreatAssess feature when querying a specific Indicator, depending on a number of variables: whether ThreatAssess is enabled, whether the ThreatAssess background monitor has run against the Indicator, whether the Indicator has been rated by appropriate owners, etc. However, the nature of ThreatAssess, its configuration, and its capabilities are outside the scope of this document. 

If a ThreatAssess score is available for a queried Indicator, it will be included, as shown to the right, for that indicator.

###Bulk Indicator Reports

If retrieving all of the Indicators and their entire context (i.e., tags, attributes, etc.) from a Source, then the above API calls can become unwieldy and require a high volume of successive calls. ThreatConnect can be configured to publish a daily bulk report of all Indicators per Owner for Sources and Communities within the Graphical User Interface (GUI). These reports can be accessed via the V2 API, and users should contact their ThreatConnect System Administrator to enable bulk reporting.

#### Checking the Status of Bulk Indicator Reports

> Example of verifying that a Community or Source has bulk-reporting enabled:

```
GET /v2/indicators/bulk?owner=Demo+Customer+Community
```
> Checking bulkStatus Object JSON Response:

```json
{
 "bulkStatus": {
  "name": "Demo Customer Community",
  "csvEnabled": true,
  "jsonEnabled": true,
  "nextRun": "2015-03-27T05:00:00Z",
  "lastRun": "2015-03-26T19:06:53Z",
  "status": "Complete"
 }
}
```

> Checking bulkStatus Object XML Response:

```xml
<BulkStatus>
 <Name>Demo Customer Community</Name>
 <CsvEnabled>true</CsvEnabled>
 <JsonEnabled>true</JsonEnabled>
 <NextRun>2015-03-27T05:00:00Z</NextRun>
 <LastRun>2015-03-26T19:06:53.344Z</LastRun>
 <Status>Complete</Status>
</BulkStatus>
```

The response body will contain a bulkStatus object, which provides details of the configuration for the bulk-reporting feature of this Community or Source:
- "name": The name of the Owner queried
- "csvEnabled": Whether the owner has enabled Comma Separated Values (CSV) reports to be generated (true/false), thus determining if the respective endpoint will yield data
- "jsonEnabled": Whether the owner has enabled JSON reports to be generated (true/false), thus determining if the respective endpoint will yield data
- "nextRun": The ISO 8601 time-stamp representing when the report generator will run next
- "lastRun": The ISO 8601 time-stamp representing when the report generator was last run
- "status": A string representing the status of the most-recent report job (Complete, Failure, etc.)

####Retrieving Bulk Reports

Reports can be retrieved in JSON or CSV format. The JSON format will contain additional context in a new format, including Attributes and Tags, if relevant. CSV reports contain an Indicator, its Type, its Threat Rating, and its Confidence value.

#####JSON Bulk Reports

> Retrieving Bulk Reports JSON Response:

```json
{
 "indicator": [{
    "id": 126650,
    "ownerName": "Demo Customer Community",
    "type": "Host",
    "dateAdded": "2013-11-15T21:32:39Z",
    "lastModified": "2015-03-03T06:22:03Z",
    "rating": 5.0,
    "confidence": 73,
    "threatAssessRating": 4.38,
    "threatAssessConfidence": 93.43,
    "webLink": "https://app.threatconnect.com/tc/auth/indicators/details/host.xhtml?host=example.com&owner=Demo+Customer+Community",
    "description": "This is probably a bad domain.",
    "summary": "example.com",
    "attribute": [{
     "id": 131253,
     "type": "Source",
     "dateAdded": "2013-11-15T21:32:40Z",
     "lastModified": "2013-11-15T21:32:40Z",
     "displayed": true,
     "value": "ThreatConnect Intelligence Research Team Enrichment"
    }, {
     "id": 149457,
     "type": "Description",
     "dateAdded": "2013-11-15T21:32:40Z",
     "lastModified": "2013-11-15T21:32:40Z",
     "displayed": true,
     "value": "This is probably a bad domain."
    }],
    "tag": [{
     "name": "China",
     "webLink": "https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=China&owner=Demo Customer Community"
    }]
   }]
 }
```

To query for a JSON report, execute the following query and include the Owner with to query. Note that the Owner must have JSON report publication enabled. 

In the example below, the JSON report is being downloaded for the Demo Customer Community:

`GET /v2/indicators/bulk/json?owner=Demo+Customer+Community`

The API will return the latest version of the JSON report with a content-type header of "application/json." The output is very similar to that returned by the Indicators Collection (e.g., in /v2/indicators), with the addition of Attributes and Tags where relevant. The example below displays a fully populated Indicator Object from the JSON report. New fields have been placed in bold type for emphasis, and the list has been truncated for brevity.

#####CSV Bulk Reports

> Example of a CSV report being downloaded for the Demo Customer Community:

```
GET /v2/indicators/bulk/csv?owner=Demo+Customer+Community
```

> The example below displays the output from a CSV report:

```
Type,Value,Rating,Confidence
Host,example.com,null,null
Address,192.168.31.136,3.00,0
File,ABCDE123456804A61F2A704811F51BC,3.00,55
URL,http://www.example.com/malware.exe,null,0
EmailAddress,spearphisher@example.com,3.00,62
```

To query for a CSV report, execute the query below, and include the Owner to be queried. Note that the owner must have CSV Report publication enabled. 

The API will return the latest CSV report with a content-type header of "text/csv." The report will contain all of the Indicators in that Owner and their Indicator Type. It will also include each Indicator’s Threat Rating and Confidence value, if set, or null otherwise. 

###Working with Groups

####Groups Service Resource Type

> Example of an Groups Service query for a generic Collection of Groups Resources for a user’s Organization:

```
/v2/groups?resultStart=0&resultLimit=20
```

> Example of an Groups Service query for a generic Collection of Groups Resources to the Communities to which a user has access:

```
/v2/groups?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Generic Groups Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 4,
  "group": [{
   "id": 3094,
   "name": "Incident 1",
   "type": "Incident",
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T18:15:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094"
  }, {
   "id": 3095,
   "name": "Threat 1",
   "type": "Threat",
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T18:18:32Z",
   "webLink": "https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095"
  }]
 }
}
```

> Generic Groups Resource Type XML Response:

```xml
<groupsResponse>
 <Status>Success</Status>
 <Data xsi:type="groupListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>4</ResultCount>
  <Group>
   <Id>3094</Id>
   <Name>Incident 1</Name>
   <Type>Incident</Type>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T18:15:49Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094</WebLink>
  </Group>
  <Group>
   <Id>3095</Id>
   <Name>Threat 1</Name>
   <Type>Threat</Type>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T18:18:32Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095</WebLink>
  </Group>
 </Data>
</groupsResponse>
```

A list of Groups from both the Indicators and Tags Service, as detailed in Table 15, can be retrieved.

<b>Table 16 - Groups Resource Type</b>

Paths                                           | Owner <br> Allowed | Pagination <br> Required
-------------------------------------------------|---------------|---------------------
`/v2/groups`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups`  |               |                     
`/v2/tags/<tag name>/groups`                      |               |                     
`/v2/securityLabels/<security label name>/groups` |               |                     
`/v2/groups/<group type>/<ID>/groups`             |               |                     
`/v2/victims/<ID>/groups`                         |               |  

From the Groups Service, a query can be made for specific Group Collection types such as Threats, Incidents, etc.

####Incidents Resource Type

> Example of an Groups Service query for a generic Collection of Incidents for a user’s Organization:

```
/v2/groups/incidents?resultStart=0&resultLimit=20
```

> Example of an Groups Service query for a generic Collection of Incidents to the Communities to which a user has access:

```
/v2/groups/incidents?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of a Group Service query of a specific Incident for a user’s Organization:

```
/v2/groups/incidents/3094
```

> Incidents Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "incident": [{
   "id": 3094,
   "name": "Incident 1",
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T18:15:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094",
   "eventDate": "2013-11-04T00:00:00Z"
  }, {
   "id": 3103,
   "name": "Incident 2",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T17:49:26Z",
   "webLink": "https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3103",
   "eventDate": null
  }]
 }
}
```

> Incidents Resource Type XML Response:

```xml
<incidentsResponse>
 <Status>Success</Status>
 <Data xsi:type="incidentListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Incident>
   <Id>3094</Id>
   <Name>Incident 1</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T18:15:49Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094</WebLink>
   <EventDate>2013-11-04T00:00:00Z</EventDate>
  </Incident>
  <Incident>
   <Id>3103</Id>
   <Name>Incident 2</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T17:49:26Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3103</WebLink>
  </Incident>
 </Data>
</incidentsResponse>
```

A list of Incidents from both the Indicators and Tags Service, as detailed in Table 16, can be retrieved.

<b>Table 17 - Incidents Resource Type</b>

Paths                                                       | Owner <br> Allowed | Pagination <br> Required
------------------------------------------------------------|---------------|---------------------
`/v2/groups/incidents`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/incidents`  |               |                     
`/v2/tags/<tag name>/groups/incidents`                      |               |                     
`/v2/securityLabels/<security label name>/groups/incidents` |               |                     
`/v2/groups/<group type>/<ID>/groups/incidents`             |               |                     
`/v2/victims/<ID>/groups/incidents`                         |               |                     

The Groups service allows for the querying of a specific Incident for a user’s Organization, as well as any Communities to which a user has access:

####Incident Resource Type

> Incident Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "incident": {
   "id": 3094,
   "name": "Incident 1",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T18:15:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094",
   "eventDate": "2013-11-04T00:00:00Z"
  }
 }
}
```

> Incident Resource Type XML Response:

```xml
<incidentResponse>
 <Status>Success</Status>
 <Data xsi:type="incidentResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Incident>
   <Id>3094</Id>
   <Name>Incident 1</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T18:15:49Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094</WebLink>
   <EventDate>2013-11-04T00:00:00Z</EventDate>
  </Incident>
 </Data>
</incidentResponse>
```

> Incident Resource Type JSON Response Including Incident Status:

```json
{
 "status": "Success",
 "data": {
  "incident": {
   "id": 3094,
   "name": "Incident 1",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T18:15:49Z",
   "webLink": "https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094",
   "eventDate": "2013-11-04T00:00:00Z",
   "status": "None"
  }
 }
}
```

> Incident Resource Type XML Response Including Incident Status:

```xml
<incidentResponse>
 <Status>Success</Status>
 <Data xsi:type="incidentResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Incident>
   <Id>3094</Id>
   <Name>Incident 1</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T18:15:49Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=3094</WebLink>
   <EventDate>2013-11-04T00:00:00Z</EventDate>
   <Status>None</Status>
  </Incident>
 </Data>
</incidentResponse>
```

<b>Table 18 - Incident Resource Type</b>

Paths                       | Owner <br> Allowed | Pagination <br> Required
----------------------------|---------------|---------------------
`/v2/groups/incidents/<ID>` | FALSE         | FALSE      
`/v2/groups/incidents/<ID>?includeAdditional=true` | FALSE         | FALSE      

For each Incident, its Attributes, associated Indicators, Security Labels, Victims, Victim Assets, and Tags can be retrieved.

Adding the ‘includeAdditional’ parameter will return the same information as `/v2/groups/incidents/<ID>` except that it will also include the Incident’s status.

####Documents Resource Type

> Example of an Groups Service query for a Collection of Documents for a user's organization:

```
/v2/groups/documents?resultStart=0&resultLimit=20
```

> Example of an Indicator Service query for a Collection of Documents to the Communities to which a user has access:

```
/v2/groups/documents?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of the Documents Resource Type query of a specific Document using the the Document’s unique ID:

```
/v2/groups/documents/734899
```

> Documents Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "document": [{
   "id": 734899,
   "name": "20030626 IIS Log",
   "ownerName": "Acme Corp",
   "dateAdded": "2015-03-13T18:10:57Z",
   "webLink": "https://app.threatconnect.com/tc/auth/document/document.xhtml?document=734899"
  }, {
   "id": 668959,
   "name": "20150115 Pcap",
   "ownerName": "Acme Corp",
   "dateAdded": "2015-01-16T19:07:31Z",
   "webLink": "https://app.threatconnect.com/tc/auth/document/document.xhtml?document=668959"
  }]
 }
}
```

> Documents Resource Type XML Response:

```xml
<documentsResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="documentListResponseData">
  <ResultCount>2</ResultCount>
  <Document>
   <Id>734899</Id>
   <Name>20030626 IIS Log</Name>
   <OwnerName>Acme Corp</OwnerName>
   <DateAdded>2015-03-13T18:10:57Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/document/document.xhtml?document=734899</WebLink>
  </Document>
  <Document>
   <Id>668959</Id>
   <Name>20150115 Pcap</Name>
   <OwnerName>Acme Corp</OwnerName>
   <DateAdded>2015-01-16T19:07:31Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/document/document.xhtml?document=668959</WebLink>
  </Document>
 </Data>
 <documentsResponse>
```

The Groups Service allows for the querying of a specific Document for a user’s Organization, as well as any Communities to which a user has access, using the Document’s unique ID.

A list of Documents from both the Indicators and Tags Service, as detailed in Table 18, can be retrieved.

<b>Table 19 - Documents Resource Type</b>

Paths                                                       | Owner <br> Allowed | Pagination <br> Required
------------------------------------------------------------|---------------|---------------------
`/v2/groups/documents`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/documents`  |               |                     
`/v2/tags/<tag name>/groups/documents`                      |               |                     
`/v2/securityLabels/<security label name>/groups/documents` |               |                     
`/v2/groups/<group type>/<ID>/groups/documents`             |               |                     
`/v2/victims/<ID>/groups/documents`                         |               |                     

####Document Resource Type

> Document Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "document": {
   "id": 734899,
   "name": "20030626 IIS Log",
   "owner": {
    "id": 665,
    "name": "Acme Corp",
    "type": "Organization"
   },
   "dateAdded": "2015-03-13T18:10:57Z",
   "webLink": "https://app.threatconnect.com/tc/auth/document/document.xhtml?document=734899",
   "fileName": "20030626 IIS Logs.txt",
   "fileSize": 5979,
   "status": "Success"
  }
 }
}
```

> Document Resource Type XML Response:

```xml
<documentResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="documentResponseData">
  <Document>
   <Id>734899</Id>
   <Name>20030626 IIS Log</Name>
   <Owner xsi:type="organization">
    <Id>665</Id>
    <Name>Acme Corp</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2015-03-13T18:10:57Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/document/document.xhtml?document=734899</WebLink>
   <fileName>20030626 IIS Logs.txt</fileName>
   <fileSize>5979</fileSize>
   <status>Success</status>
  </Document>
 </Data>
</documentResponse>
```

<b>Table 20 - Document Resource Type</b>

Paths                       | Owner <br> Allowed | Pagination <br> Required
----------------------------|---------------|---------------------
`/v2/groups/documents/<ID>` | FALSE         | FALSE               

Note that the data has a field named "Status" that denotes if the document is still in the process of being uploaded and stored within ThreatConnect.

For each Document, its Attributes, associated Indicators, Security Labels, Victims, Victim Assets, and Tags can be retrieved.

####Threats Resource Type

> Example of an Groups Service query for a specific Threat for a user's organization:

```
/v2/groups/threats?resultStart=0&resultLimit=20
```

> Example of an Groups Service query for a specific Threat to the Communities to which a user has access:

```
/v2/groups/threats?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of a Group Service query of a specific Threat:

```
/v2/groups/threats/3095
```

> Threats Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "threat": [{
   "id": 3095,
   "name": "Threat 1",
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T18:18:32Z",
   "webLink": "https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095"
  }, {
   "id": 3104,
   "name": "Threat 2",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T18:00:28Z",
   "webLink": "https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3104"
  }]
 }
}
```

> Threats Resource Type XML Response:

```xml
<threatsResponse>
 <Status>Success</Status>
 <Data xsi:type="threatListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Threat>
   <Id>3095</Id>
   <Name>Threat 1</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T18:18:32Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095</WebLink>
  </Threat>
  <Threat>
   <Id>3104</Id>
   <Name>Threat 2</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T18:00:28Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3104</WebLink>
  </Threat>
 </Data>
</threatsResponse>
```

A list of Threats from both the Indicators and Tags Service, as detailed in Table 20, can be retrieved.

<b>Table 21 - Threats Resource Type</b>

Paths                                                     | Owner <br> Allowed | Pagination <br> Required
----------------------------------------------------------|---------------|---------------------
`/v2/groups/threats`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/threats`  |               |                     
`/v2/tags/<tag name>/groups/threats`                      |               |                     
`/v2/securityLabels/<security label name>/groups/threats` |               |                     
`/v2/groups/<group type>/<ID>/groups/threats`             |               |                     
`/v2/victims/<ID>/groups/threats`                         |               |                     

The Groups Service allows for the querying of a specific Threat for a user’s Organization, as well as any Communities to which a user has access:

####Threat Resource Type

> Threat Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "threat": {
   "id": 3095,
   "name": "Threat 1",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T18:18:32Z",
   "webLink": "https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095"
  }
 }
}
```

> Threat Resource Type XML Response:

```xml
<threatResponse>
 <Status>Success</Status>
 <Data xsi:type="threatResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Threat>
   <Id>3095</Id>
   <Name>Threat 1</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T18:18:32Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/threat/threat.xhtml?threat=3095</WebLink>
  </Threat>
 </Data>
</threatResponse>
```

<b>Table 22 - Threat Resource Type</b>

Paths                     | Owner <br> Allowed | Pagination <br> Required 
--------------------------|---------------|---------------------
`/v2/groups/threats/<ID>` | FALSE         | FALSE               
 
For each Threat, its Attributes, associated Indicators, Security Labels, Victims, Victim Assets, and Tags can be retrieved.

####Adversaries Resource Type

> Example of an Groups Service query for a Collection of Adversaries for a user's organization:

```
/v2/groups/adversaries?resultStart=0&resultLimit=20
```

> Example of an Groups Service query for a Collection of Adversaries to the Communities to which a user has access:

```
/v2/groups/adversaries?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of a Group Service query for a specific Adversary within a user's Organization:

```
/v2/groups/adversaries/3093
```

> Adversaries Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "adversary": [{
   "id": 3093,
   "name": "Adversary 1",
   "ownerName": "Organization Name",
   "dateAdded": "2013-11-20T01:23:21Z",
   "webLink": "https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3093"
  }, {
   "id": 3105,
   "name": "Adversary 2",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T18:07:28Z",
   "webLink": "https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3105"
  }]
 }
}
```

> Adversaries Resource Type XML Response:

```xml
<adversariesResponse>
 <Status>Success</Status>
 <Data xsi:type="adversaryListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Adversary>
   <Id>3093</Id>
   <Name>Adversary 1</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-11-20T01:23:21Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3093</WebLink>
  </Adversary>
  <Adversary>
   <Id>3105</Id>
   <Name>Adversary 2</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T18:07:28Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3105</WebLink>
  </Adversary>
 </Data>
</adversariesResponse>
```

The Groups Service allows for the querying of a Collection of Adversaries for both a user’s Organization, as well as any Communities to which a user has access.

A list of Adversaries from both the Indicators and Tags Service, as detailed in Table 22, can be retrieved.

<b>Table 23 - Adversaries Resource Type</b>

Paths                                                       | Owner <br> Allowed | Pagination <br> Required
-------------------------------------------------------------|---------------|---------------------
`/v2/groups/adversaries`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/adversaries`  |               |                     
`/v2/tags/<tag name>/groups/adversaries`                      |               |                     
`/v2/securityLabels/<security label name>/groups/adversaries` |               |                     
`/v2/groups/<group type>/<ID>/groups/adversaries`             |               |                     
`/v2/victims/<ID>/groups/adversaries`                         |               |                     

The Groups Service allows for the querying of a specific Adversary for a user’s Organization, as well as any Communities to which a user has access.

####Adversary Resource Type

> Adversary Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "adversary": {
   "id": 3093,
   "name": "Adversary 1",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-11-20T01:23:21Z",
   "webLink": "https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3093"
  }
 }
}
```

> Adversary Resource Type XML Response:

```xml
<adversaryResponse>
 <Status>Success</Status>
 <Data xsi:type="adversaryResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Adversary>
   <Id>3093</Id>
   <Name>Adversary 1</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-11-20T01:23:21Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/adversary/adversary.xhtml?adversary=3093</WebLink>
  </Adversary>
 </Data>
</adversaryResponse>
```

<b>Table 24 - Adversary Resource Type</b>

Paths                         | Owner <br> Allowed | Pagination <br> Required 
------------------------------|---------------|---------------------
`/v2/groups/adversaries/<ID>` | FALSE         | FALSE               

For each Adversary, its Attributes, associated Indicators, Security Labels, Victims, Victim Assets, and Tags can be retrieved.

####Emails Resource Type

> Example of an Groups Service query for a Collection of Emails for a user's organization:

```
/v2/groups/emails?resultStart=0&resultLimit=20
```

> Example of an Groups Service query for a Collection of Emails to the Communities to which a user has access:

```
/v2/groups/emails?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of a Groups Service query of a specific Email:

`/v2/groups/emails/3108`

> Emails Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "email": [{
   "id": 3108,
   "name": "[ATTENTION]Mail System Update",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T18:29:37Z",
   "webLink": "https://app.threatconnect.com/tc/auth/email/email.xhtml?email=3108",
   "score": 0
  }]
 }
}
```

> Emails Resource Type XML Response:

```xml
<emailsResponse>
 <Status>Success</Status>
 <Data xsi:type="emailListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>1</ResultCount>
  <Email>
   <Id>3108</Id>
   <Name>[ATTENTION]Mail System Update</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T18:29:37Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/email/email.xhtml?email=3108</WebLink>
   <Score>0</Score>
  </Email>
 </Data>
</emailsResponse>
```

The Groups Service allows for the querying of a Collection of Emails for a user’s Organization, as well as any Communities to which a user has access.

A list of Emails from both the Indicators and Tags Service, as detailed in Table 24, can be retrieved.

<b>Table 25 - Email Resource Type</b>

Paths                                                  | Owner <br> Allowed | Pagination <br> Required
--------------------------------------------------------|---------------|---------------------
`/v2/groups/emails`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/emails`  |               |                     
`/v2/tags/<tag name>/groups/emails`                      |               |                     
`/v2/securityLabels/<security label name>/groups/emails` |               |                     
`/v2/groups/<group type>/<ID>/groups/emails`             |               |                     
`/v2/victims/<ID>/groups/emails`                         |               |                     


The Groups Service allows for the querying of a specific Email for a user’s Organization, as well as any Communities to which a user has access.

####Email Resource Type

> Email Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "email": {
   "id": 3108,
   "name": "[ATTENTION]Mail System Update",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-12-22T18:29:37Z",
   "webLink": "https://app.threatconnect.com/tc/auth/email/email.xhtml?email=3108",
   "to": "",
   "from": "hostmaster@mail-linkedin.com",
   "subject": "[ATTENTION]Mail System Update",
   "score": 0,
   "header": " header content...",
   "body": "body content..."
  }
 }
}
```

> Email Resource Type XML Response:

```xml
<emailResponse>
 <Status>Success</Status>
 <Data xsi:type="emailResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Email>
   <Id>3108</Id>
   <Name>[ATTENTION]Mail System Update</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-12-22T18:29:37Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/email/email.xhtml?email=3108</WebLink>
   <To />
   <From>hostmaster@mail-linkedin.com</From>
   <Subject>[ATTENTION]Mail System Update</Subject>
   <Score>0</Score>
   <Header>
    <![CDATA[header content]]>
   </Header>

   <Body>
    <![CDATA[body content]]>
   </Body>
  </Email>
 </Data>
</emailResponse>
```

<b>Table 26 - Email Resource Type</b>

Paths                    | Owner <br> Allowed | Pagination <br> Required
-------------------------|---------------|---------------------
`/v2/groups/emails/<ID>` | FALSE         | FALSE               

Note that the "to" field may be empty if the field was not supplied when the email was uploaded.

For each Email, its Attributes, associated Indicators, Security Labels , Victims , Victim Assets , and Tags can be retrieved.

####Signatures Resource Type

> Example of a Groups Service query for a Collection of Signatures for a user's organization:

```
/v2/groups/signatures?resultStart=0&resultLimit=20
```

> Example of a Groups Service query for a Collection of Signatures to the Communities to which a user has access:

```
/v2/groups/signatures?owner=Common%20Community&resultStart=0&resultLimit=20
```

> Example of a Groups Service allows for the querying of a specific Signature:

```
/v2/groups/signatures/3106
```

> Signatures Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "signature": [{
   "id": 3106,
   "name": "Signature 1",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T18:13:23Z",
   "webLink": "https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3106",
   "fileType": "SNORT"
  }, {
   "id": 3107,
   "name": "Signature 2",
   "ownerName": "Organization Name",
   "dateAdded": "2013-12-22T18:13:47Z",
   "webLink": "https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3107",
   "fileType": "SNORT"
  }]
 }
}
```

> Signatures Resource Type XML Response:

```xml
<signaturesResponse>
 <Status>Success</Status>
 <Data xsi:type="signatureListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Signature>
   <Id>3106</Id>
   <Name>Signature 1</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T18:13:23Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3106</WebLink>
   <fileType>SNORT</fileType>
  </Signature>
  <Signature>
   <Id>3107</Id>
   <Name>Signature 2</Name>
   <OwnerName>Organization Name</OwnerName>
   <DateAdded>2013-12-22T18:13:47Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3107</WebLink>
   <fileType>SNORT</fileType>
  </Signature>
 </Data>
</signaturesResponse>
```

The Groups Service allows for the querying of a Collection of Signatures for a user’s Organization, as well as any Communities to which a user has access.

A list of Signatures from both the Indicators and Tags service, as detailed in Table 26, can be retrieved.

<b>Table 27 - Signatures Resource Type</b>

Paths                                                        | Owner <br> Allowed | Pagination <br> Required
-------------------------------------------------------------|---------------|---------------------
`/v2/groups/signatures`                                      | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/groups/signatures`  |               |                     
`/v2/tags/<tag name>/groups/signatures`                      |               |                     
`/v2/securityLabels/<security label name>/groups/signatures` |               |                     
`/v2/groups/<group type>/<ID>/groups/signatures`             |               |                     
`/v2/victims/<ID>/groups/signatures`                         |               |                     

The Groups Service allows for the querying of a specific Signature for a user’s Organization, as well as any Communities to which a user has access.

####Signature Resource Type

> For each Signature, the Signature content can be downloaded:

```
/v2/groups/signatures/3106/download
```

> Signature Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "signature": {
   "id": 3106,
   "name": "Signature 1",
   "owner": {
    "id": 1,
    "name": "Organization Name",
    "type": "Organization"
   },
   "dateAdded": "2013-12-22T18:13:23Z",
   "webLink": "https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3106",
   "fileType": "SNORT",
   "fileName": "signature1.txt"
  }
 }
}
```

> Signature Resource Type XML Response:

```xml
<signatureResponse>
 <Status>Success</Status>
 <Data xsi:type="signatureResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Signature>
   <Id>3106</Id>
   <Name>Signature 1</Name>
   <Owner xsi:type="organization">
    <Id>1</Id>
    <Name>Organization Name</Name>
    <Type>Organization</Type>
   </Owner>
   <DateAdded>2013-12-22T18:13:23Z</DateAdded>
   <WebLink>https://app.threatconnect.com/tc/auth/signature/signature.xhtml?signature=3106</WebLink>
   <fileType>SNORT</fileType>
   <fileName>signature1.txt</fileName>
  </Signature>
 </Data>
</signatureResponse>
```

<b>Table 28 - Signature Resource Type</b>

Paths                        | Owner <br> Allowed | Pagination <br> Required 
-----------------------------|---------------|---------------------
`/v2/groups/signatures/<ID>` | FALSE         | FALSE               

For each Signature, the Signature content can be downloaded, and the response format will mirror the content of the Signature upload.

For each Signature, its Attributes, associated Indicators, Security Labels, Victims, Victim Assets, and Tags can be retrieved.

####Attributes Resource Type

> Example Attribute Paths:

```
/v2/groups/signatures/3106/attributes
/v2/indicators/emailAddresses/test@baddomain.com/attributes
```

> Attributes Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "attribute": [{
   "id": 11,
   "type": "Honeypot",
   "dateAdded": 1385406165000,
   "value": "Winnie the Poo's honeypot"
  }, {
   "id": 13,
   "type": "Malware Controller Availability",
   "dateAdded": 1385406214000,
   "value": "Underground malware control possible at target location."
  }]
 }
}
```

> Attributes Resource Type XML Response:

```xml
<attributesResponse>
 <Status>Success</Status>
 <Data xsi:type="attributeListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Attribute>
   <Id>11</Id>
   <Type>Honeypot</Type>
   <Value>Winnie the Poo's honeypot</Value>
   <DateAdded>2013-11-25T14:02:45-05:00</DateAdded>
  </Attribute>
  <Attribute>
   <Id>13</Id>
   <Type>Malware Controller Availability</Type>
   <Value>Underground malware control possible at target location.</Value>
   <DateAdded>2013-11-25T14:03:34-05:00</DateAdded>
  </Attribute>
 </Data>
</attributesResponse>
```

Attributes are extra metadata that can be added to Indicators and Groups and are not retrieved as independent objects like Indicators and Groups. They are always with another item, such as a Host or a Threat. To retrieve a list of Attributes, append the Attributes path onto a specific Indicator or Group.

A list of Attributes from both the Indicators and Groups Services, as detailed in Table 29, can be retrieved.

<b>Table 29 - Attributes Resource Type</b>

Paths                                                | Owner <br> Allowed | Pagination <br> Required
-----------------------------------------------------|---------------|---------------------
`/v2/indicators/<indicator type>/<value>/attributes` | TRUE          | TRUE                
`/v2/groups/<group type>/<ID>/attributes`            | FALSE         |                     

Note that all relevant Security Labels for an Attribute can be queried.

###Working With Tags

> Path for all Tags:

```
/v2/tags
```

All Tags, including the Tags with which an Indicator or Group has been tagged, as well as the Indicators or Groups of a specific Tag for a user’s Organization, as well as any Communities to which a user has access, can be found with the Tag Service.

A list of Tags from both the Indicators and Groups Services, as detailed in Table 30, can be retrieved.

####Tags Resource Type

> Tags Resource Type JSON Response:

> Example Tags Service query of a specific Tag:

```
/v2/tags/tag%201
```

```json
{
 "status": "Success",
 "data": {
  "resultCount": 2,
  "tag": [{
   "name": "tag 1",
   "webLink": "https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag 1&owner=Organization Name"
  }, {
   "name": "tag 2",
   "webLink": "https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag 2&owner=Organization Name"
  }]
 }
}
```

> Tags Resource Type XML Response:

```xml
<tagsResponse>
 <Status>Success</Status>
 <Data xsi:type="tagListResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <ResultCount>2</ResultCount>
  <Tag>
   <Name>tag 1</Name>
   <WebLink>https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag 1&amp;owner=Organization Name</WebLink>
  </Tag>
  <Tag>
   <Name>tag 2</Name>
   <WebLink>https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag 2&amp;owner=Organization Name</WebLink>
  </Tag>
 </Data>
</tagsResponse>
```

<b>Table 30 - Tags Resource Type</b>

Paths                                          | Owner <br> Allowed | Pagination <br> Required
-----------------------------------------------|---------------|---------------------
`/v2/tags`                                     | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/tags` | TRUE          |                     
`/v2/groups/<group type>/<ID>/tags`            | FALSE         |                     

The Tags Service allows for the querying of a specific Tag for both a user’s Organization, as well as any Communities to which the user has access.

####Tag Resource Type
        
> Tag Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "tag": {
   "name": "tag 1",
   "webLink": "https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag%201&owner=Organization Name"
  }
 }
}
```

> Tag Resource Type XML Response:

```xml
<tagResponse>
 <Status>Success</Status>
 <Data xsi:type="tagResponseData" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Tag>
   <Name>tag 1</Name>
   <WebLink>https://app.threatconnect.com/tc/auth/tags/tag.xhtml?tag=tag%201&amp;owner=Organization Name</WebLink>
  </Tag>
 </Data>
</tagResponse>
```

<b>Table 31 - Tag Resource Type</b>

Paths                 | Owner <br> Allowed | Pagination <br> Required
----------------------|---------------|---------------------
`/v2/tags/<tag name>` | TRUE          | FALSE   

For each Tag, its associated Indicators and Groups can be found.

###Working with Security Labels

> Path for all Security Labels: 

```
/v2/securityLabels
```

All Security Labels, including the Security Labels that have been applied to an Indicator or Group, the Indicators or Groups labeled with a specific Security Label for both a user’s Organization, as well as any Communities to which a user has access, can be found using the Security Label Service.

####Security Labels Resource Type

> Example The SecurityLabels Service query of a specific Security Label:

```
/v2/securityLabels/SECURITY%20LABEL%20NAME
```

> SecurityLabels Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "securityLabel": {
   "name": "SECURITY LABEL NAME"
  }
 }
}
```

> SecurityLabels Resource Type XML Response:

```xml
<securityLabelsResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="securityLabelListResponseData">
  <ResultCount>1</ResultCount>
  <SecurityLabel>
   <Name>SECURITY LABEL NAME</Name>
  </SecurityLabel>
 </Data>
</securityLabelsResponse>
```

A list of Security Labels from the Indicator, Group, and Task Services, as detailed in Table 31, can be retrieved.

<b>Table 32 - SecurityLabels Resource Type</b>

Paths                                                                    | Owner <br> Allowed | Pagination <br> Required 
-------------------------------------------------------------------------|---------------|---------------------
`/v2/securityLabels`                                                     | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/securityLabels`                 | TRUE          |                     
`/v2/groups/<group type>/<ID>/securityLabels`                            | FALSE         |                     
`/v2/indicators/<indicator type>/<value>/attributes/<ID>/securityLabels` | TRUE          |                     
`/v2/groups/<group type>/<ID>/attributes/<ID>/securityLabels`            | FALSE         |                     
`/v2/tasks/<ID>/securityLabels`                   | TRUE | 
`/v2/tasks/<ID>/attributes/<ID>/securityLabels`                   | TRUE | 

The SecurityLabels Service allows for the querying of a specific Security Label for a user’s Organization, as well as any Communities to which the user has access.

####Security Label Resource Type

> SecurityLabel Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "securityLabel": {
   "name": "SECURITY LABEL NAME"
  }
 }
}
```

> SecurityLabel Resource Type XML Response:

```xml
<securityLabelResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="securityLabelResponseData">
  <SecurityLabel>
   <Name>SECURITY LABEL NAME</Name>
  </SecurityLabel>
 </Data>
</securityLabelResponse>
```

<b>Table 33 - SecurityLabel Resource Type</b>

Paths                                      | Owner <br> Allowed | Pagination <br> Required
-------------------------------------------|---------------|---------------------
`/v2/securityLabels/<security label name>` | TRUE          | TRUE                

For each SecurityLabel, its associated Indicators and Groups can be found.

### Working with Tasks

> Retrieve all Tasks that can be accessed by this API User 

```
GET /v2/tasks
```
Tasks will be shown for the API user’s Organization and Communities that they can access.

> Retrieve a specific Task

```
GET /v2/tasks/<task_id>

Sample Response to 
GET /v2/tasks/599

{
    "status": "Success",
    "data": {
        "task": {
            "id": 599,
            "name": "Test Task",
            "owner": {
                "id": 1,
                "name": "System",
                "type": "Organization"
            },
            "dateAdded": "2016-04-12T13:36:43-04:00",
            "webLink": "https://localhost:8443/auth/workflow/task.xhtml?task=599",
            "status": "In Progress",
            "escalated": false,
            "reminded": false,
            "overdue": false,
            "dueDate": "2016-04-12T13:36:53-04:00",
            "reminderDate": "2016-04-12T13:36:53-04:00",
            "escalationDate": "2016-04-12T13:36:53-04:00"
        }
    }
}
```

> Retrieve the list of people assigned to a specific Task

```
GET /v2/tasks/<task_id>/assignees
```

> Retrieve the list of Escalatees ("people who will be notified when the deadline passes") for a specific Task

```
GET /v2/tasks/<task_id>/escalatees
```

> Create a new Task; Escalatees and Assignees may be a list of `userName` entries

```
POST /v2/tasks/
{
  “name” : “Task Name”,
  “escalatee” : { “userName” : “manager@threatconnect.com” },
  “assignee” : { “userName” : “worker@threatconnect.com”}
}

```

> Update the due date (a `DateTime` object) and description for a Task

```
POST /v2/tasks/<task_id>/attributes
{
  "dueDate" : {"2016-03-20T13:36:53-04:00"}, 
  "description": {"A thing we need to do"}
}
```

Multiple Assignees or Escalatees may be provided by adding additional `username` entries as a list.

> Add the user denoted by `username` to the list of Escalatees

```
POST /v2/tasks/<task_id>/escalatees/<username>
```

> Add the user denoted by `username` to the list of Assignees

```
POST /v2/tasks/<task_id>/assignees/<username>
```

> Remove the user denoted by `username` from the list of Escalatees

```
DELETE /v2/tasks/<task_id>/escalatees/<username>
```

> Remove the user denoted by `username` from the list of Assignees

```
DELETE /v2/tasks/<task_id>/assignees/<username>
```

> Retrieve all Indicators associated with a specific Task

```
GET /v2/tasks/<task_id/indicators
```

A list of Indicators, Tags, and Security Labels that are related to each Task may be listed by querying the [API endpoints for each type of Indicator or Group ](#resource-types).

####Victims Resource Type

> Retrieve a specific Victim by ID

```
/v2/groups/victims/<victim_ID>
```

> Victims Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "victim": [{
   "id": 527,
   "name": "Example Victim",
   "org": "Demo Org",
   "suborg": "HR Department",
   "workLocation": "Washington D.C.",
   "nationality": "American",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }]
 }
}
```

> Victims Resource Type XML Response:

```xml
<victimsResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="victimListResponseData">
  <ResultCount>1</ResultCount>
  <Victim>
   <Id>527</Id>
   <Name>Example Victim</Name>
   <Org>Test Org</Org>
   <Suborg>HR Department</Suborg>
   <WorkLocation>Washington D.C.</WorkLocation>
   <Nationality>American</Nationality>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </Victim>
 </Data>
 <statusCode>OK</statusCode>
</victimsResponse>
```

A list of Tasks from both the Indicators and Groups Services, as detailed in Table 34, can be retrieved.

Paths                                             | Owner <br> Allowed | Pagination <br> Required 
--------------------------------------------------|---------------|---------------------
`/v2/victims`                                     | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/victims` | TRUE          |                     
`/v2/groups/<group type>/<ID>/victims`            | FALSE         |                     

The Victims Service allows for the querying of a specific Victim for the user’s Organization, as well as any Communities to which the user has access.


###Working With Victims

> Retrieve all Victims in a user’s Organization and in any Communities to which a user has access.

```
/v2/victims
```

By using the Victims Service, all Victims for a user’s Organization, as well as any Communities to which a user has access, can be retrieved.

####Victims Resource Type

> Retrieve a specific Victim by ID

```
/v2/groups/victims/<victim_ID>
```

> Victims Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "resultCount": 1,
  "victim": [{
   "id": 527,
   "name": "Example Victim",
   "org": "Demo Org",
   "suborg": "HR Department",
   "workLocation": "Washington D.C.",
   "nationality": "American",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }]
 }
}
```

> Victims Resource Type XML Response:

```xml
<victimsResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="victimListResponseData">
  <ResultCount>1</ResultCount>
  <Victim>
   <Id>527</Id>
   <Name>Example Victim</Name>
   <Org>Test Org</Org>
   <Suborg>HR Department</Suborg>
   <WorkLocation>Washington D.C.</WorkLocation>
   <Nationality>American</Nationality>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </Victim>
 </Data>
 <statusCode>OK</statusCode>
</victimsResponse>
```

A list of Victims from both the Indicators and Groups Services, as detailed in Table 34, can be retrieved.

<b>Table 34 - Victim List Resource Type</b>

Paths                                             | Owner <br> Allowed | Pagination <br> Required 
--------------------------------------------------|---------------|---------------------
`/v2/victims`                                     | TRUE          | TRUE                
`/v2/indicators/<indicator type>/<value>/victims` | TRUE          |                     
`/v2/groups/<group type>/<ID>/victims`            | FALSE         |                     

The Victims Service allows for the querying of a specific Victim for the user’s Organization, as well as any Communities to which the user has access.

####Victim Resource Type

> Victim Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "victim": {
   "id": 527,
   "name": "Example Victim",
   "description": "This victim got hacked.",
   "org": "Test Org",
   "suborg": "HR Department",
   "workLocation": "Washington D.C.",
   "nationality": "American",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }
 }
}
```

> Victim Resource Type XML Response:

```xml
<victimResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="victimResponseData">
  <Victim>
   <Id>527</Id>
   <Name>Example Victim</Name>
   <Description>This victim got hacked.</Description>
   <Org>Test Org</Org>
   <Suborg>HR Department</Suborg>
   <WorkLocation>Washington D.C.</WorkLocation>
   <Nationality>American</Nationality>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </Victim>
 </Data>
 <statusCode>OK</statusCode>
</victimResponse>
```

<b>Table 35 - Victim Resource Type</b>

Paths              | Owner <br> Allowed | Pagination <br> Required
-------------------|---------------|---------------------
`/v2/victims/<ID>` | FALSE         | FALSE               

For each Victim, its Attributes, associated Groups, Indicators, Tags, and available Owners can be retrieved.

####Victim Tags Resource Type

> View all Tags for a given Victim

```
GET /v2/victims/<victim_ID>/tags
```

> View a specific Tag for a given Victim

```
GET /v2/victims/<victim_ID>/tags/<tag_name>
```

> Add a Tag to a given Victim

```
POST /v2/victims/<victim_ID>/tags/<tag_name>
```

> Remove a Tag from a given Victim

```
DELETE /v2/victims/<victim_ID>/tags/<tag_name>
```

Tags can be applied to Victims [in the same manner as other objects](#working-with-tags), allowing filtering and searching.

####Victim Security Labels Resource Type

> View all Security Labels for a given Victim

```
GET /v2/victims/<victim_ID>/securityLabels
```

> View a specific Security Label for a given Victim

```
GET /v2/victims/<victim_ID>/securityLabels/<security_label_name>
```

> View all Victims for a given Security Label

```
GET /v2/victims/securityLabels/<security_label_name>/victims
```

> Add a Security Labels to a given Victim

```
POST /v2/victims/<victim_ID>/securityLabels/<security_label_name>
```

> Add a Victim to a given Security Label

```
POST /v2/victims/securityLabels/<security_label_name>/victims/<victim_ID>
```

> Remove a Security Label from a given Victim

```
DELETE /v2/victims/<victim_ID>/securityLabels/<security_label_name>
```

> Remove a Victim from a given Security Label

```
DELETE /v2/victims/securityLabels/<security_label_name>/victims/<victim_ID>
```

Security Labels can be applied to Victims [in the same manner as other objects](#working-with-security-labels), allowing access and sharing restrictions.

#### Victim Attributes Resource Type

> View Victim Attributes for a given Victim

```
GET /v2/victims/<victim_ID>/attributes
```

> View a specific Victim Attribute for a given Victim

```
GET /v2/victims/<victim_ID>/attributes/<attribute_ID>
```

> View all Security Labels for a given Victim Attribute

```
GET /v2/victims/<victim_ID>/attributes/<attribute_ID>/securityLabels
```

> View Security Label for a given Victim Attribute

```
GET /v2/victims/<victim_ID>/attributes/<attribute_ID>/securityLabels/<security_label_name>
```

> Add an Attribute to a given Victim Attribute

```
POST /v2/victims/<victim_ID>/attributes
```

> Add a Security Label to a given Victim Attribute

```
POST /v2/victims/<victim_ID>/attributes/<attribute_ID>/securityLabels/<security_label_name>
```

> Update an Attribute on a given Victim Attribute

```
PUT /v2/victims/<victim_ID>/attributes/<attribute_ID>
```

> Remove an Attribute from a given Victim Attribute

```
DELETE /v2/victims/<victim_ID>/attributes/<attribute_ID>
```

> Remove a Security Label from a given Victim Attribute

```
DELETE /v2/victims/<victim_ID>/attributes/<attribute_ID>/securityLabels/<security_label_name>
```

Attributes can be added to Victims [in the same manner as other objects](#attributes), allowing enriched context. 

####Victim Assets Resource Type

> victimAssets Resource Type JSON Response:

```json
{
 "status": "Success",
 "data": {
  "victimAsset": [{
   "id": 727,
   "name": "demo@victim.org",
   "type": "EmailAddress",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }, {
   "id": 729,
   "name": "jbadguy",
   "type": "NetworkAccount",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }, {
   "id": 731,
   "name": "555-867-5309",
   "type": "Phone",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }, {
   "id": 728,
   "name": "@VictimGuy47",
   "type": "SocialNetwork",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }, {
   "id": 730,
   "name": "www.joevictim.net",
   "type": "WebSite",
   "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527"
  }]
 }
}
```

> victimAssets Resource Type XML Response:

```xml
<victimAssetsResponse>
 <Status>Success</Status>
 <Data xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="victimAssetListResponseData">
  <VictimAsset>
   <Id>727</Id>
   <Name>demo@victim.org</Name>
   <Type>EmailAddress</Type>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </VictimAsset>
  <VictimAsset>
   <Id>729</Id>
   <Name>jbadguy</Name>
   <Type>NetworkAccount</Type>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </VictimAsset>
  <VictimAsset>
   <Id>731</Id>
   <Name>555-867-5309</Name>
   <Type>Phone</Type>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </VictimAsset>
  <VictimAsset>
   <Id>728</Id>
   <Name>@VictimGuy47</Name>
   <Type>SocialNetwork</Type>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </VictimAsset>
  <VictimAsset>
   <Id>730</Id>
   <Name>www.joevictim.net</Name>
   <Type>WebSite</Type>
   <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
  </VictimAsset>
 </Data>
 <statusCode>OK</statusCode>
</victimAssetsResponse>
```

Victim Assets can also be found by querying the victimAssets Collection. The victimAssets Collection will return all Assets attached to a specified Victim ID.

<b>Table 36 - VictimAssets Resource Type</b>

Paths                           | Owner <br> Allowed | Pagination <br> Required
--------------------------------|---------------|---------------------
`/v2/victims/<ID>/victimAssets` | FALSE         | FALSE               

As Table 37 displays, each specific type of Victim Asset can be queried.

<b>Table 37</b>

Paths<br>Victim Asset Type                 | Owner <br> Allowed | Pagination <br> Required
------------------------------------------------|---------------|---------------------
`/v2/victims/<ID>/victimAssets/emailAddresses`  | FALSE         | FALSE               
emailAddress                                    |               |
`/v2/victims/<ID>/victimAssets/networkAccounts` | FALSE         | FALSE  
networkAccount                                  |               |
`/v2/victims/<ID>/victimAssets/phoneNumbers`    | FALSE         | FALSE  
phoneType                                       |               |
`/v2/victims/<ID>/victimAssets/socialNetworks`  | FALSE         | FALSE   
socialNetwork                                   |               |
`/v2/victims/<ID>/victimAssets/webSites`        | FALSE         | FALSE   
WebSite                                         |               |

> Sample query and response for emailAddress

```json
{
 "id": 727,
 "type": "EmailAddress",
 "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527",
 "address": "demo@victim.org",
 "addressType": "Personal"
}
```

```xml
<VictimEmailAddress>
 <Id>727</Id>
 <Type>EmailAddress</Type>
 <WebLink>https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527</WebLink>
 <Address>demo@victim.org</Address>
 <AddressType>Personal</AddressType>
</VictimEmailAddress>
```

> Sample query and response for networkAccount 

```json
 {
  "id": 729,
  "type": "NetworkAccount",
  "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527",
  "account": "jbadguy",
  "network": "victim.org domain"
 }
```

```xml
<VictimNetworkAccount>
 <Id>729</Id>
 <Type>NetworkAccount</Type>
 <WebLink>https://app.threatconnect.com/tc /auth/victim/victim.xhtml?victim=527
 </WebLink>
 <Account>jbadguy</Account>
 <Network>victim.org domain</Network>
</VictimNetworkAccount>
```

> Sample query and response for  "phoneType"       

```json
 {
  "id": 731,
  "type": "Phone",
  "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527",
  "phoneType": "555-867-5309"
 }
```

```xml
<VictimPhone>
 <Id>731</Id>
 <Type>Phone</Type>
 <WebLink>https://app.threatconnect.com/tc /auth/victim/victim.xhtml?victim=527
 </WebLink>
 <PhoneType>555-867-5309</PhoneType>
</VictimPhone>        
```

> Sample query and response for socialNetwork   

```json
{
 "id": 728,
 "type": "SocialNetwork",
 "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527",
 "account": "@VictimGuy47",
 "network": "Twitter"
}
```

```xml
<VictimSocialNetwork>
 <Id>728</Id>
 <Type>SocialNetwork</Type>
 <WebLink>https://app.threatconnect.com/tc /auth/victim/victim.xhtml?victim=527
 </WebLink>
 <Account>@VictimGuy47</Account>
 <Network>Twitter</Network>
</VictimSocialNetwork>
```

> Sample query and response for WebSite        

```json
 {
  "id": 730,
  "type": "WebSite",
  "webLink": "https://app.threatconnect.com/tc/auth/victim/victim.xhtml?victim=527",
  "webSite": "www.joevictim.net"
 }
```

```xml
<VictimWebSite>
 <Id>730</Id>
 <Type>WebSite</Type>
 <WebLink>https://app.threatconnect.com/tc /auth/victim/victim.xhtml?victim=527
 </WebLink>
 <WebSite>www.joevictim.net</WebSite>
</VictimWebSite>    
```

###Writing to the API

<b>Introduction</b>

Version 2 of the ThreatConnect API allows for programmatic creation, updating, and deleting of data within ThreatConnect, which includes Indicators and Groups, their Attributes and Tags, and even Associations. This section outlines the standards for managing these operations.
Many of the following examples for creating, updating, and deleting data will use various HTTP methods. Please note that the authentication rules detailed in the Calculating the Signature section still apply for these additional methods. Thus, each of the requests listed below will require time-stamp and authorization headers, which have been omitted from the examples for brevity and readability.

####Creating New Entities

Creation is handled in the V2 API via the HTTP POST method. This is done by creating a body containing the entity’s information and attaching it to a POST request to the relevant service. The body must be in valid JSON or XML, with contents and format mimicking the data structure when querying the API. 

> The example below displays an API call that creates a new IP address:

```
POST /v2/indicators/addresses
Host: api.threatconnect.com
Content-Type: application/json
{
"ip" : "192.168.1.100"
"rating" : "5.0",
"confidence" : 100
}
```

The URL associated with the POST request contains the path that will inform the V2 API of where the entity is to be created. In the example above, it specifies that it would like to create an Indicator, or, more specifically, an address. Note that the content-type header is configured to application/json to inform the API that the body will be in JSON format.
The body of the POST request contains a simple JSON object that specifies information about the entity. In this instance, it creates the IP Address 192.168.1.100 with an Threat Rating of 5 and a Confidence value of 100. For the sake of re-usability, these fields will use the same names, values, and formats as those returned by the API when trying to retrieve values.

####Indicators

> The following are all considered valid paths for creating indicators:

```
POST /v2/indicators/addresses
POST /v2/indicators/emailAddresses
POST /v2/indicators/files
POST /v2/indicators/hosts
POST /v2/indicators/urls
```

> Sample results for `address` query

```json
 {
  "ip": "192.168.0.1",
  "rating": "5.0",
  "confidence": 100
 }                                             
```

> Sample results for ` emailAddresses ` query

```json
 {
  "address": "example@badguy.com",
  "rating": "5.0",
  "confidence": 100
 }                                              
```

> Sample results for `files` query

```json
{
 "md5": "2FFA00BB67FC936B01E3DE234A01A8D8",
 "sha1": "111EE6465425DF9A06CC14934DFFEE5EF36DE7E3",
 "sha256": "FD320CE6E64A816B3DC22DAE1AEA9B5D84       
 C197E1265AE3880B3A2A45A543D051 ",                     
 "size": 5366,
 "rating": "5.0",
 "confidence": 100
}                                                                                
```

> Sample results for `hosts` query

```json
{
 "hostName": "badguy.com",
 "dnsActive": "false",
 "whoisActive": "true",
 "rating": "5.0",
 "confidence": 100
}                                       
```


> Sample results for `urls` query

```json
{
 "text": "http://badguy.com/bad.php",
 "rating": "5.0",
 "confidence": 100
}
```

The V2 API will allow for the programmatic creation of Indicators by issuing POST requests with valid bodies to the appropriate resources. 

Likewise, Table 38 illustrates valid fields for inclusion in the body of the POST request when creating an Indicator.

<b>Table 38</b>

| Indicator Type | Valid Fields |  Required |
|----------------|--------------|----------|
| addresses      | ip           | TRUE         |
|                | rating       | FALSE    |
|                | confidence   |FALSE    |
|                |              |    |
|                |              |           |
| emailAddresses | address      | TRUE         |
|                | rating       | FALSE    |
|                | confidence   | FALSE   |
|                |              |     |
| files          | md5          |  TRUE*        |
|                | sha1         |  TRUE*    |
|                | sha256       | TRUE*    |
|                | size         | FALSE    |
|                | rating       | FALSE    |
|                | confidence   |FALSE    |
|                |          |          |
| hosts          | hostName     |  TRUE        |
|                | dnsActive     | FALSE    |
|                | whoisActive | FALSE    |
|                | rating      | FALSE    |
|                | confidence  | FALSE    |
|                |              |          |
| urls           | text         |TRUE        |
|                | rating       | FALSE     |
|                | confidence   | FALSE    |


*Files are required to be submitted with at least one valid hash.

####Files

> The file-occurrence object returned by the API details the structure used to model the name, run path, and date for one observed occurrence of this file:

```
"fileOccurence" : [ {
"fileName" : "win999301.dll",
"path" : "C:\\Windows\\System",
"date" : "2014-11-03T00:00:00-05:00"
}, {
"fileName" : "win093023.dll",
"path" : "C:\\Windows\\System32",
"date" : "2014-11-06T00:00:00-05:00"
} ]
```

> Utilizing a pivot-like functionality, the API allows for the creation of fileOccurrences by specifying a valid hash for an existing File Indicator:

```
POST /v2/indicators/files
Host: api.threatconnect.com
Content-Type: application/json

{
"md5" : "BE7DE2F0CF48294400C714C9E28ECD01",
"sha1" : "4067DF19928C00D521E5D14B851C88897EF40401",
"sha256" : "EC6B6F2B4EF1A97F8C9751B4539A38ECE25BD2928497E44BB6A61829707DD301",
"size" : 5566
}

POST /v2/indicators/files/BE7DE2F0CF48294400C714C9E28ECD01/fileOccurrences
Host: api.threatconnect.com
Content-Type: application/json

{
"fileName" : "win999301.dll",
"path" : "C:\\Windows\\System",
"date" : "2014-11-03T00:00:00-05:00"
}
```

File Indicators are different from other Indicator types because they can have any combination of multiple hashes, as well as file-specific fields.
When creating a file, specify any or all of these hashes just as in the ThreatConnect web client, with at least one hash required. Note that due to the complications surrounding possible collisions, there is no option to add or remove these hash associations, as there is in the GUI, after the file is created. 
Files also have additional data structures to model instances of a file’s occurrences in the wild. 

####Groups

> For example, the following POST request would create a new Incident named "Remote Access Incident" that occurred on October 20, 2014:

```
POST /v2/groups/incidents
Host: api.threatconnect.com
Content-Type: application/json
{
"name" : "Remote Access Incident",
"eventDate" : "2014-10-20T00:00:00-04:00"
}
```

> This response will contain the newly created Group ID for future use, just as if the Group had been queried for specifically:

```
HTTP/1.1 201 CREATED
Content-Type: application/json
{
"status" : "Success",
"data" : {
"incident" : {
"id" : 119842,
"name" : "Remote Access Incident ",
"owner" : {
"id" : 1749,
"name" : "Test Org",
"type" : "Organization"
},
"dateAdded" : "2014-10-28T17:30:33-04:00",
"webLink" : " https://app.threatconnect.com/tc/auth/incident/incident.xhtml?incident=119842",
"eventDate" : "2014-10-20T00:00:00-04:00"
}
}
}
```

> Sample `adversaries` query output

```json
 {                                             
 "name" : "Baron von Badguy"                     
 }                                             
```

> Sample `documents` query output

```json
 {                                             
                                               
 "name" : "Example Report",                      
 "fileName" : "apt_report.pdf"                 
 }                                             
```

> Sample `emails` query output

```json
{
 "name": "Example Email",
 "to": "victim@helpless.net",
 "from": "badguy@badguy.net",
 "subject": "Your Paycheck.exe",
 "header": "Delivered-To: victim@helpless.net\n 
 Received: by 10.36.81.3 with SMTP id
 e3cs239nzb;Tue,
 29 Mar 2005 15: 11: 47 -
  0800(PST)\ nReturn - Path: \nReceived: from mail.emailprovider.com(mail.emailprovider.com[111.111.11.111])
 by mx.gmail.com with SMTP id 2005.03.
 29.15.11.46;Tue,
 29 Mar 2005 15: 11: 47 -
  0800(PST)\ nMessage - ID: 25.62086.mail@ mail.emailprovider.com > \nReceived: from[11.11.111.111] by mail.provider.
 com via HTTP;Tue,
 29 Mar 2005 15: 11: 45
 PST\ nDate: Tue,
 29 Mar 2005 15: 11: 45 -
  0800(PST)\ nFrom: Bad Guy\ nSubject: Your
 Paycheck.exe\ nTo: John Victim ",               
 "body": "Please open your paycheck at          
 www.badguy.net / johnvictim / paycheck.exe.
 "      
}                              
```

> Sample `incidents` query output

```json
 {                                             
 "name" : "Bad November Incident",               
 "eventDate" : "2014-11-04T12:40:53-05:00"       
 }                                             
```

> Sample `threats` query output

```json
 {                                             
 "name" : "Example APT"                          
 }                                             
```

> Sample `signatures` query output

```json
{                                             
 "name" : "Bad Guy Detection Signature",         
 "fileName" : "example_sig.txt",                 
 "fileType" : "YARA",                            
 "fileText" : "\"rule example_sig : example\n{\n 
 meta:\n description = \"This                  
 is just an example\"\n\n                      
 strings:\n $a = {6A 40 68 00                  
 30 00 00 6A 14 8D 91}\n $b =                  
 {8D 4D B0 2B C1 83 C0 27 99 6A 4E             
 59 F7 F9}\n condition:\n                      
 $a or $b or $c\n}\""                          
}                                             
```

Groups are different from Indicators, since they do not require unique names; rather, the system assigns unique identifiers. As a result, the Group is created with the relevant information, such as the name, and the V2 API will return the newly created object, including its ID, for future reference.

NOTE: The content’s variable names and values take the same form as those returned when polling for a specific Incident. The V2 ThreatConnect API maintains this congruency intentionally to make reusing values easier.

If created successfully, the V2 API will respond with a response detailing the Group created. 

Table 39 details the acceptable fields and values when creating a Group.

<b>Table 39</b>

| Group Type  | Valid Fields | Required |
|-------------|--------------|----------|
| adversaries | name         | TRUE     |
| documents   | fileName     | TRUE     |
|             | name        | TRUE     |
|             | malware     | FALSE     |
|             | password     | FALSE     |
| emails      | name         | TRUE     |
|             | to           | FALSE    |
|             | from         | FALSE    |
|             | subject      | TRUE     |
|             | header       | TRUE     |
|             | body         | TRUE     |
| incidents   | name         | TRUE     |
|             | eventDate    | TRUE     |
| threats     | name         | TRUE     |
| signatures  | name         | TRUE     |
|             | fileName     | TRUE     |
|             | fileType*    | TRUE     |
|             | fileText**   | TRUE     |

*The valid values for a Signature’s fileType field are: {Snort ® , Suricata, YARA, ClamAV ® , OpenIOC, CybOX™, Bro}.
**A Signature’s fileText field contains the Signature itself, which must be properly escaped and encoded when submitting for creation or updating.

####Documents

> First, create a new Document given its filename

```
POST /v2/groups/documents/
Host: api.threatconnect.com
Content-Type: application/json
{ 
 "fileName" : "report.pdf",
 "name": "My Report"
}

```

> Next, receive a globally unique ID for the Document (if creation was successful)

```json
{                                          
  "data": 
  {
   "document":
   { 
   "id": "<DOCUMENT_ID>"
   }
  }
}
```

> Finally, for the given Document ID, upload the Document content in the POST body (for instance using `curl --data @filename`)

```
POST /v2/groups/documents/<DOCUMENT_ID>/upload
Host: api.threatconnect.com
Content-Type: application/octet-stream
<raw_document>
```

> To update the Document, use an HTTP PUT with the same Document ID - and the new Document content in the PUT body

```
PUT /v2/groups/documents/<DOCUMENT_ID>/upload
Host: api.threatconnect.com
Content-Type: application/octet-stream
<raw_document>
```


To upload a new Document:

- Create a new Document Group by passing its on-disk `filename` and descriptive `name` to `v2/groups/documents` as `json` data
- Receive the generated Document ID for the new Document Group from the server
- Upload the raw Document content using HTTP POST given its ID to `/v2/groups/documents/<DOCUMENT_ID>/upload` as an `octet-stream`
(A Document may be updated using an HTTP PUT to this same endpoint)

NOTE: Any filetype may be uploaded to the system, which are stored and not rendered for security considerations

#### Malware Documents

> Include the `malware` and `password` fields to create a new Document for a malicious file

```
POST /v2/groups/documents/
Host: api.threatconnect.com
Content-Type: application/json
{ 
 "fileName" : "malwaresample.zip",
 "name": "Malicious File",
 "malware": True,
 "password": "TCinfected"
}

```

To upload a malware sample as a Document:

- Create a [password-protected zip file](https://askubuntu.com/questions/17641/create-encrypted-password-protected-zip-file) on your local machine containing the sample
- Create a new Document Group [as above](#documents), including the additional fields `malware` set to True and `password` set to the zip file password
- Upload the document [as above](#documents)

NOTE: Uploading raw malware executables or weaponized documents is strictly forbidden

For malware uploads, An `HTTP 400 - Bad Request` error will be returned if the document is not a password-protected zip file (as determined by file headers)

####Attributes

> The request below adds a "Source" Attribute with the value "Proprietary  Reporting" to the "Remote Access Incident" created above:

```
POST /v2/groups/incidents/119842/attributes
Host: api.threatconnect.com
Content-Type: application/json
{
"type" : "Source",
"value" : "Proprietary  Reporting",
"displayed" : true
}
```

> Rules and mappings as defined by the Organizational Administrator:

```
HTTP/1.1 201 CREATED
Content-Type: application/json
{
"status" : "Success",
"data" : {
"attribute" : {
"id" : 43875,
"type" : "Source",
"dateAdded" : "2014-10-28T17:39:27-04:00",
"lastModified" : "2014-10-28T17:39:27-04:00",
"displayed" : false,
"value" : "Proprietary  Reporting"
}
}
}
```

Attributes can also be programmatically created via the V2 API. The path must identify the entity to which to attach an Attribute, and the POST body must contain the name and value of the Attribute. 

Similarly to creating a Group, the API will respond with the newly created Attribute just as if the user had queried for that Attribute. Note that this response will contain the Attribute’s ID, which can be useful for deleting or modifying this Attribute in the future. Attributes must conform to the Attribute Validation.

NOTE: The Attributes can have a displayed field, which is equivalent to specifying that an Attribute should be treated as the "Default" in the GUI. This distinction is important for the Source and Description Attributes, which will be displayed at the top of an Indicator or Group screen, as well as on a Browse screen resource.

####Victims

> To create a Victim, simply POST a request with the Victim’s name to the Victims Service:

```
POST /v2/victims
Host: api.threatconnect.com
Content-Type: application/json
{
"name" : "Victim Name"
}
```

> Victim Assets can also be created by POSTing a request to the appropriate service, for example:

```
POST /v2/victims/victimAssets/emailAddresses
Host: api.threatconnect.com
Content-Type: application/json
{
"address" : "victim@demo.net",
"addressType" : "Personal"
}
```

Victims can be created programmatically, as can their Assets.

Creating a Victim in this fashion will return a Victim object as if it been queried for directly. 

NOTE: These Asset paths and field names will be identical to those outlined in the Victims section.

####Updating Entities

> The PUT request below will update the Confidence value for a specific Host Indicator to 80:

```
PUT /v2/indicators/hosts/baddomain.net
Host: api.threatconnect.com
Content-Type: application/json
{
"confidence" : 80
}
```

> The PUT request below will update the "Threat Level" Attribute (identified by Attribute ID 54321) of an Incident to "Severe":

```
PUT /v2/groups/incidents/123456/attributes/54321
Host: api.threatconnect.com
Content-Type: application/json
{
"value" : "Severe"
}
```

Just as the POST method is used to create Entities, the PUT method can also be used to specify updates to Entities. The specification of the Entity occurs in the actual path, while the updated fields are specified in the body. Note that all valid fields specified in the body will overwrite existing fields. 

It is important to capture and use the ID to specify a Group or Attribute. The field names and acceptable values are the same as those used to create an Entity. Reference the tables above for example body submissions for Indicators and Groups .
A Document’s content can be updated using a PUT request and the same format used during the initial upload, as described in the Documents section.

####Deleting Entities

> The following example will delete a specified email address "falsepositive@highvolume.net":

```
DELETE /v2/indicators/emailAddresses/falsepositive@highvolume.net
Host: api.threatconnect.com
```

> The following example will delete the Attribute identified by ID #12345 from the Threat identified by ID #666:

```
DELETE /v2/groups/threats/666/attributes/12345
Host: api.threatconnect.com
```

Entities can be deleted using the HTTP DELETE method. With proper permissions, this allows for the programmatic removal of data from ThreatConnect just as if it were done in the web client.

NOTE: It is important to capture and use the ID to specify a Group or Attribute.

####Retrieving Available Associations

> To retrieve all of the available associations, use the following GET request:

```
GET /v2/types/associationTypes/
```

> To retrieve information about a specific association, use the following GET request format:

```
GET /v2/types/associationTypes/<association_type_name>/
```

> This GET request will return details about the "Adversary" association type:

```
GET /v2/types/associationTypes/adversaries/Adversary/
```

All of the available associations can be viewed by making a `GET` request to `/v2/types/associationTypes`.  This will return the name of the association and, if applicable, the Indicator/Group Resources between which the association can be created.  To get information about a specific association, add the association type to the end of the query above such as: `/v2/types/associationTypes/<association_type_name>`.

####Creating Associations

> In order to see all IP Addresses associated with an Incident, issue the following query:

```
GET /v2/groups/incidents/119842/indicators/addresses
```

> To add an Association between the above Incident and unassociated IP Address 10.0.2.5, the following POST request could be issued:

```
POST /v2/groups/incidents/119842/indicators/addresses/10.0.2.5
```

> In keeping with the bidirectional nature of Associations and pivoting, the Association can be created by pivoting off the Address:

```
POST /v2/indicators/addresses/10.0.2.5/groups/incidents/119842
```

> This Association mechanic can also be used to add Tags to a Group or an Indicator, again in either direction:

```
POST /v2/groups/incidents/119842/tags/China
POST /v2/tags/China/groups/incidents/119842
```

> This Association mechanic can also be used to set Security Labels to a Group or an Indicator, again in either direction:

```
POST /v2/groups/incidents/119842/securityLabels/Sensitive
POST /v2/securityLabels/sensitive/groups/incidents/119842
```

Associations can be created via a POST command by structuring the path in a manner similar to the pivoting detailed above. Associations do not need a body to be sent along, as the path conveys all the information necessary.

A query would return a list of Addresses in the same format as the `/v2/indicators/addresses` query. The distinction is that the query above will only return a list of Addresses that are associated to the specified Incident.
This same pivoting syntax is used to create an Association. 

NOTE: This will not create the Address in the system if the Address does not exist; this call only serves to associate the two.

####Deleting Associations

> In the example below, the Association between a Threat and an email address can be removed if it is no longer relevant:

```
DELETE /v2/groups/threats/666/indicators/emailAddresses/oldhat@irrelevant.net
```

> To remove a Tag that is no longer applicable:

```
DELETE /v2/indicators/emailAddresses/oldhat@irrelevant.net/tags/APT
```

With the understanding of how Associations are created, Association deletion becomes trivial. Using the HTTP DELETE command, a specified Association can be deleted.

####Batch Upload: Indicators

> Sample Batch Create request

```
 POST /v2/batch/                 
 {                               
 "haltOnError": "false",         
 "attributeWriteType": "Replace", 
 "action": "Create",             
 "owner": "Common Community"     
 }                               
```

> Server Response on Success

```
 HTTP/1.1 201 Created                       
 {                                          
 batchId: "123"                             
 }                                          
```

> Server Response on Insufficient Privileges

```
 HTTP/1.1 403 Forbidden                     
 {                                          
 status: "Not Authorized",                  
 description: "Organization not authorized  
 for batch"                                 
 }                                          
```

> Server Response on Incorrect Settings

```
 HTTP/1.1 403 Forbidden                     
 {                                          
 status: "Not Authorized",                  
 description: "Document storage not enabled 
 for this instance"                         
 }                                          
```

> The following is an example of a Batch Indicator Input file:

```json
{
  
  "ownerName": "<String>", 
  "type": "<String>",
  "rating": "<BigDecimal>",
  "confidence": "<Short>",
  "description": "<String>",
  "summary": "<String>",
  
  "tag": [
    {
      "name": "<String>"
    }
        ]
}
```

> Sample Batch Upload Input File request

```
 POST /v2/batch/123                                               
                                                                  
 Content-Type: application/octet-stream; boundary=[boundary-text] 
 Content-Length: <data_size>                                         
 Content-Encoding: gzip       
 [boundary-text]                                                  
 <uploaded_data>                                              
 ```
 
 > Server Response on Success
 
 ```
 HTTP/1.1 202 Accepted                
 {                                    
 status: "Queued"    
 }                                    
```

> Server Response on Overlarge Input File

```
  HTTP/1.1 400 Bad Request             
 {                                    
 status: "Invalid",                   
 description: "File size greater than 
 allowable limit of 2000000"          
 }                                    
 ```

> Sample Batch Status Check request

```
 GET /v2/batch/123        
```

> Server Response on Success (job still running)

```
  HTTP/1.1 200 OK                             
 {                                           
 status: "Running",                          
 }                                           
 ```
 
> Server Response on Success (job finished)

```
  HTTP/1.1 200 OK                             
 {                                           
 status: "Completed",                        
 errorCount: 3420,                           
 successCount: 405432                        
 unprocessCount: 0                           
 }                                                                                      
 ```
 
> Sample Batch Error Message request

```
 GET /v2/batch/123/errors 
 ```
 
> Server Response on Success (job still running)

```
 HTTP/1.1 400 Bad Request                    
 {                                           
 status: "Invalid",                          
 description: "Batch still in Running state" 
 }                                           
 ```

> Server Response on Success (job finished):

```
  HTTP/1.1 200 OK                             
 Content-Type: application/octet-stream ; boundary=<boundary-text>                  
 Content-Length: <data_size>                       
 Content-Encoding: gzip                      
 <boundary-text>                             
 <response_data>                          
 ```

<b>Create Batch Endpoint</b>
 
The Batch API allows bulk Indicator creation and deletion via the HTTP POST method. After creating a batch, an Indicator file is uploaded. The content of the file must be valid JSON, with content and format mimicking the data structure of the Bulk JSON file download. A file upload instantly triggers a batch job to begin processing the data. The Batch API is restricted to Indicators and will improve performance when importing large amounts of data.

NOTE: Document Storage is required to use the Batch API.

The Batch Create resource creates a batch entry in the system. No batch processing is triggered until the batch input file is uploaded. Table 40 displays the fields required for the Batch Create message.

<b>Table 40</b>

| BatchConfig Message | Values           | Description                                                                                                                                                                                                                     
|---------------------|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
| haltOnError         | true / false     | The batch process will stop processing the entire batch the first time it reaches an error during processing.          
|                     |                  | If this field is not provided, the default behavior is to continue processing further entities in the input file.                                           
|                     | default=false    |                                                                                                                                                                                                                                 
| attributeWriteType  | Append / Replace | Append: Add attributes (allow duplicates)                                                                                                                                                                                       
|                     |                  |                                                                                                                                                                                                                                 
|                     |                  | Replace: Delete current attributes; Add/Validate new                                                                                                                                                                            
| action              | Create / Delete  | Create: Create Indicator                                                                                                                                                                                                        
|                     |                  |                                                                                                                                                                                                                                 
|                     |                  | Delete: Delete Indicator (only the ‘summary’ and ‘type’ field are required)                                                                                                                                                     

### Batch Indicator Input File Format
```json
[
  {
        "rating": 3,
        "confidence": 60,
        "description": "a malicious domain",
        "summary": "super-malicious.ru",
        "type": "Host", 
        "attribute": [
            {
                "type": "AttributeName",
                "value": "MyAttribute"
            }
            ],
        "tag": [
         {
           "name": "MyTag"
         }
        ]
  }
]
```

The batch upload feature expects to ingest a JSON file consisting of a list of dictionaries 

|Field | Data type| Required?|
|:--------|--------|-------|
`rating` | integer  |Required
`confidence` | float|Required
`description` | string |Required
`summary` | string |Required
`type` | string|Required
`tag` | list of dictionaries| Optional
`attribute` | list of dictionaries| Optional

Supported `Type` values for Indicators:

- Host
- Address
- EmailAddress
- URL
- File

Note: Exporting indicators via the `JSON Export` feature in ThreatConnect will create a file in this format

<b>Upload Batch Input File Endpoint</b>

Batch files should be sent as HTTP POST data to a REST endpoint, including the relevant `batchId`

<b>Check Batch Status Endpoint</b>

You may also check the status of a running batch upload job

The server can be configured to restrict the file size. Clients can submit multiple batches for larger files.

Possible GET response status includes:

- Created
- Queued
- Running
- Completed

If `haltOnError` is set to ‘true’ and an error occurs, then the status will be set to ‘Completed’, and ‘errorCount’ will be greater than zero. The ‘unprocessedCount’ field will be greater than zero, unless the uploaded file did not contain valid JSON.

Partial failures will have an error file with a response having a ‘reason text’, which includes Tag, Attribute, or Indicator errors (fail on first).

###Responses

The API will return appropriate HTTP response codes with a description in the message field as detailed in Table 40. This can be helpful when troubleshooting queries.

<b>Table 41</b>

HTTP Response Code          | Explanation                                                                                                             
-----------------------------|-------------------------------------------------------------------------------------------------------------------------
 200 - Success               | Successful execution of a request.                                                                                       
 201 - Created               | The query successfully created the specified entity.                                                                    
 400 - Bad Request           | Status returned if the request was not properly formatted. <br>The message included with the response will include details. 
 401 - Unauthorized          | Returned if a user does not have access to the specified <br> resource or the method attempted on a resource.
 403 - Forbidden             | Returned when specifying an Owner to which the user does do <br>not have access, or does not exist.                          
 403 - Bad Request           | This Indicator is included in a system-wide exclusion list.
 404 - Not Found             | The service or resource specified in the path does not exist.                                                           
 500 - Internal Server Error | An unknown internal error                                                                                               
 503 - Service Unavailable   | The Instance of ThreatConnect is not licensed to enable the API.                                                        

###Putting Everything Together

With the information thus far included in this document, users are ready to start issuing queries to the ThreatConnect API. This section contains some examples of cases that will help users define queries to fulfill their Organizations’ needs.

####Retrieving All IP Addresses with a Certain Tag

> Using paginated queries, a user can continue to pull the remaining IP Addresses, if they number more than the default page size:

```
/v2/tags/<TAGNAME>/indicators/addresses
```

The query to the right will retrieve the first page IP Addresses within a user’s Organization that are tagged with the specified <TAGNAME> value. Note that other Indicator types, such as files or URLs, can be viewed . 

####Retrieving All Signatures from a Specific File

> A user can also take the Signature IDs from the results and issue further queries to download the Signatures themselves, as detailed in the Signatures section:

```
/v2/indicators/files/<FILE_HASH>/groups/signatures
```

The query to the right will return the first page of Signatures for the file specified by FILE_HASH . Note that an Owner can be specified for this file, which may exist in multiple Instances with different Signatures across multiple Communities. 

####Retrieving All Incidents from a Community

> Using paginated queries, a user can continue to pull the remaining Incidents, if they number more than the default page size:

```
/v2/groups/incidents?owner=Common%20Community
```

The query to the right will retrieve the first page of Incidents belonging to the Common Community. The specified Community can be replaced with any Community to which the API User has access (as determined by the Owners Service ). 

####Exploring an Incident’s Indicators of Interest

> This will return a summary of all Indicators associated to a specified Indicent:

```
/v2/groups/incidents/<INCIDENT_ID>/indicators
```

> This will return the Incident's associated file Indicators:

```
/v2/groups/incidents/<INCIDENT_ID>/indicators/files
```

> This will return the Incident's associated address Indicators:

```
/v2/groups/incidents/<INCIDENT_ID>/indicators/addresses
```

A script can parse out the details returned by the respective services to identify new and dangerous Indicators and then format them to provide real-time updates to firewalls, block lists, and other network security tools:

The first query to the right will return a summary of all Indicators associated with the Incident identified by the given INCIDENT_ID. This INCIDENT_ID could have been identified in the previous query and programmatically fed to additional queries. Note that an Owner’s identifier does not need to be supplied at this point, since Incidents’ identifiers are unique to Owners.
The second and third queries to the right will return the Incident’s associated file and Address Indicators, respectively. These queries can be combined to poll ThreatConnect for new and dangerous IPs. 

####Creating an Incident with Indicators

> Note that the first query will return the body of the newly created Incident whose ID must be captured to specify later in the third query to produce the Association:

```
POST /v2/groups/incidents
{
"name" : "Bad November Incident",
"eventDate" : "2014-11-04T12:40:53-05:00"
}


POST /v2/indicators/addresses
{
"ip" : "192.168.0.1",
"rating" : "5.0",
"confidence" : 100
}

POST /v2/groups/incidents/<NEW_INCIDENT_ID>/indicators/addresses/192.168.0.1
```

The queries below will create an Incident named "Bad November Incident," IP Address Indicator 192.168.0.1, and then associate them. 

####Tracking a "Times Seen" Attribute

>  Creates IP Address Indicator 

```
 POST /v2/indicators/addresses                            
 {                                                        
 ip : 192.168.0.1,                                    
 rating : 5.0,                                        
 confidence : 100                                       
 }                                                        
```

>   Adds the tag "Tracked" to the above IP Address

```
 POST /v2/indicators/addresses/192.168.0.1/tags/Tracked   
```

> Create the "Times Seen" Attribute on the above IP Address. Note that this Attribute Type must be created by an Organization Administrator (via the ThreatConnect web GUI).

```
 POST /v2/indicators/addresses/192.168.0.1/attributes     
 {                                                        
 type : Times Seen,                                   
 value : 0                                            
 }                                                        
```

> Get all attributes attached to an IP Address

```
 GET /v2/indicators/addresses/192.168.0.1/attributes      
```

>  Increment the "Times Seen" Attribute by one

```
 PUT /v2/indicators/addresses/192.168.0.1/attributes/1234 
 {                                                        
 value : 1                                            
 }                                                        
```

>  Remove the "Tracked" Tag from the specified IP Address

```
 DELETE /v2/indicators/addresses/192.168.0.1/tags/Tracked 
```

If a user creates an Attribute Type to track how often an Indicator is seen within a network, then those queries are helpful, since they will create an Indicator, create and update the Attribute, and add or remove Tags. Please note that some of these features will require additional processing by an API client program or integration.

An integration may want to update the "Times Seen" Attribute (such as a sensor or SIEM) when it encounters the Indicator. The first query will return all Attributes attached to the specified IP Address. An integration must iterate over all of these Attributes to identify the Integer Attribute ID it wishes to change (in this example, 1234). This is also an opportune time to capture the existing value for the "Times Seen" Attribute, so the user knows what to submit when incrementing it. 

Removing a tag from an indicator may be useful if it is no longer considered relevant based on a computation of its "Times Seen" Attribute and its creation date (or "last-seen" date, if that was also tracked as an Attribute).

# Python Library
<p <b>10007-04 EN Rev. A</b></p>

> The following is a code sample and syntax highlighting:

```python

resources = tc.adversaries()

resource = resources.add('Test Adversary')
resource.add_attribute('Description', 'Adversary Sample Description')
resource.add_tag('Sample Adversary')
try:
    resources.commit('Acme Corp')
except RuntimeError as e:
    print(e)
```


